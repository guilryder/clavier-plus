<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Clavier+ help</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252" />
<style type="text/css">
body {
font-family: verdana, arial, sans-serif;
}

dt kbd {
font-weight: bold;
}

dt {
margin-top: 1em;
}

.toc {
float: left;
}

.toc a {
color: blue;
text-decoration: none;
display: block;
padding: 2px 0px;
}
a:hover {
color: red;
text-decoration: underline;
}

.ipt {
font-weight: bold;
color: red;
}

.faq-question {
margin-top: 18pt;
border-top: 2px solid #808080;
padding-top: 2px;
padding-left: 5px;
font-weight: bold;
}

.faq-answer {
margin-left: 2em;
}

.faq-answer ul {
margin-top: 0;
margin-bottom: 0;
}

.faq-answer p {
margin-top: 6pt;
margin-bottom: 6pt;
}
</style>
</head>

<body>

<h1>Clavier+ help</h1>

<p class="toc">
<a href="#name">Why such a strange name?</a>
<a href="#author">Author</a>
<a href="#license">License</a>
<a href="#setup">Setup</a>
<a href="#utility">What can Clavier+ do</a>
<a href="#add">Create a keyboard shortcut</a>
<a href="#conditions">Conditions applied to the shortcuts</a>
<a href="#text">Text written by the shortcuts</a>
<a href="#print">Printing the shortcuts list</a>
<a href="#conffile">Configuration files</a>
<a href="#cmdline">Command line options</a>
<a href="#limits">Known issues</a>
<a href="#faq">FAQ</a>
<a href="#examples">Shortcuts examples</a>
</p>


<h2 style="clear: both"><a href="http://utilfr42.free.fr/util/Clavier.php">Clavier+ website</a></h2>


<h2 id="name">Why such a strange name?</h2>

<p><i>Clavier</i> simply is the French word for <i>keyboard</i>. Note the incredible originality of this name, and the amount of creativity deployed to find it!</p>


<h2 id="author">Author</h2>

<p>
Guillaume Ryder<br />
Website: <a href="http://utilfr42.free.fr/"><kbd>http://utilfr42.free.fr</kbd></a><br />
E-mail: <a href="mailto:gryder@club-internet.fr"><kbd>gryder@club-internet.fr</kbd></a>
</p>

<p><b>German translation</b><br />
Dietmar Vogel<br />
Website: <a href="http://www.verdrahtet.net/"><kbd>http://www.verdrahtet.net</kbd></a><br />
E-mail: <a href="mailto:info@verdrahtet.net"><kbd>info@verdrahtet.net</kbd></a>
</p>

<p><b>Brazilian Portuguese translation</b><br />
Milton C. De Almeida<br />
Website: <a href="http://mchal.110mb.com/"><kbd>http://mchal.110mb.com</kbd></a><br />
E-mail: <a href="mailto:mchal@ig.com.br"><kbd>mchal@ig.com.br</kbd></a>
</p>


<h2 id="license">License</h2>

<p>Clavier+ is under the <a href="http://www.gnu.org/copyleft/gpl.html">GPL license</a>. This gives you the right to use, copy, distribute the software, for any use (personal or commercial), all that without having to pay anything.</p>

<p>There is no warranty for this program, I’m not responsible of any damage due to its use.</p>

<p>The full source code of Clavier+ is available here:<br />
<a href="http://utilfr42.free.fr/dn/ClavierSrc.zip"><kbd>http://utilfr42.free.fr/dn/ClavierSrc.zip</kbd></a></p>


<h2 id="setup">Setup</h2>

<p>Clavier+ is distributed in two packages:</p>
<ul>
<li><b>With</b> setup program: <a href="http://utilfr42.free.fr/dn/ClavierSetup.exe"><kbd>http://utilfr42.free.fr/dn/ClavierSetup.exe</kbd></a></li>
<li><b>Without</b> setup program: <a href="http://utilfr42.free.fr/dn/Clavier.zip"><kbd>http://utilfr42.free.fr/dn/Clavier.zip</kbd></a></li>
</ul>

<p>To install Clavier+ without setup program:</p>
<ol>
<li>Download the <a href="http://utilfr42.free.fr/dn/Clavier.zip">Zip archive</a> and unzip it.</li>
<li>Launch <kbd>Clavier.exe</kbd>.</li>
<li>If you want the shortcuts to be always active, launch <kbd>Clavier.exe</kbd> again to display the configuration dialog box, then check the <i>Launch Clavier+ at Windows startup</i> checkbox.</li>
</ol>

<p>To uninstall Clavier+ without setup program:</p>
<ol>
<li>In Clavier+ configuration, uncheck the <i>Launch Clavier+ at Windows startup</i> checkbox, if necessary.</li>
<li>Quit Clavier+ by clicking the button having this name.</li>
<li>Delete all Clavier+ files.</li>
</ol>


<h2 id="utility">What can Clavier+ do</h2>

<p>Clavier allows to associate an action to any keyboard shortcut. Those actions can be:</p>
<ul>
<li>launch a program: Word, calculator, Internet browser, etc.</li>
<li>display a website</li>
<li>open a folder: <i>My documents</i>, <kbd>C:</kbd>, CD-Rom drive, etc.</li>
<li>write special characters: ® and © symbols, currency symbols like € or ¥, etc.</li>
<li>write text: E-mail address, company name, etc. in any program (Word, Internet browser, notepad)</li>
<li>simulate keystrokes, for example to execute a command in the menus of a program</li>
<li>simulate mouse clics or mouse wheel action</li>
</ul>

<p>The keyboard shortcuts can use (almost) any key of the keyboard. The Windows key, located around the spacebar, can be used along with Ctrl, Alt and Shift. As programs rarely use this key, many simple keyboard shortcuts are available: <kbd>Win + A</kbd>, <kbd>Win + 2</kbd>, <kbd>Win + .</kbd>, etc.</p>

<p>Clavier+ can modify the behavior of special keys like <kbd>`</kbd> or <kbd>F11</kbd>. Thus a keyboard shortcut of one single key can be associated to a frequently used action.</p>

<p>If necessary, the action of a keyboard shortcut can depend of the active program. This allows to add shortcuts to a specific program.</p>

<p>In the same way, the action of a keyboard shortcut can depend of the state of the toggle keys, i.e. the keys having small lights in the keyboard: Caps Lock, Num Lock, Scroll Lock. For example, this allows to write special characters instead of digits when the caps lock mode is set.</p>

<p>Clavier+ website proposes <a href="http://utilfr42.free.fr/util/Clavier.php#examples">some shortcuts examples</a>.</p>


<h2 id="add">Create a keyboard shortcut</h2>

<p>Launch Clavier+. A small keyboard icon appears in the traybar, near the system clock. It indicates that Clavier+ is running, thus keyboard shortcuts are active. Click the icon to display the configuration window. You can resize the window if you find it too small. The upper area contains some example shortcuts.</p>

<p>To create a new keyboard shortcut, click the <i>Add</i> button (having a + shape), and choose the keyboard shortcut action:</p>
<ul>
<li><b>Program:</b> execute a program of the Start menu</li>
<li><b>Internet Favorite:</b> display a website contained in the favorites of Internet Explorer (if you use another Web browser, for example Firefox, chose <i>Display a Website</i> below)</li>
<li><b>Special Character:</b> write a special character</li>
<li><b>Folder:</b> open a folder with Windows Explorer</li>
<li><b>Write text:</b> simulate text writing, and eventually simulate keystrokes (for example the <kbd>Tab</kbd> key to fill all fields of a form at once)</li>
<li><b>Launch a Program</b>: launch a program missing in the Start menu, or execute any command line</li>
<li><b>Display a Website</b>: display a website missing in Internet Explorer favorites</li>
</ul>

<p>A dialog box appears for you to specify the keyboard shortcut. Type it in the dedicated area: its text name should be written in the textbox. Then, click the <i>OK</i> button.</p>

<p>If necessary, modify the shortcut action in the lower part of the configuration window. If the shortcut should write text, for example an E-mail address, check that the <i>Write text</i> option is checked, then enter your text in the big text area. Each time you will type the keyboard shortcut, the specified text will be written. You can use the arrow menu to insert special characters or simulate a keystroke.</p>

<p>If the shortcut should launch a program or display a website, check the matching option. Write the path of your program or the address of your website in the area below. You can use the small button on the right to look for the program to launch. You can check the action of your shortcut by clicking the <i>Test</i> button. If necessary, click the <i>Advanced settings</i> button to specify the initial directory or the initial window size of the program (maximized, windowed, minimized).</p>

<p>If the shortcut opens a directory, you can allow it to change the current directory in <i>File/Open</i> dialog boxes. To do this, click the <i>Advanced settings</i> button and check <i>Change directory in File/Open dialog boxes</i>. When you execute the shortcut keystroke, Clavier+ detects whether you are in a File/Open dialog box or not. If yes, the current directory of the dialog box is changed, and the directory is not opened in Windows Explorer. Clavier+ supports several dialog boxes: File/Open, File/Save as, and directory choosing.</p>

<p><span class="ipt">Important:</span> you should close Clavier+ configuration window <i>before</i> testing your shortcuts. While the window is visible, the keyboard shortcuts are disabled.</p>


<h2 id="conditions">Conditions applied to the shortcuts</h2>

<p>You can restrict the effect of a shortcut to some conditions. If all conditions fulfill, the action of the shortcut is executed. If one or more conditions do not fulfill, Clavier+ ignores the shortcut, and the original action of the shortcut is executed (the one defined by Windows or the active program). This allows to associate different actions to the same shortcut.</p>

<p><span class="ipt">Warning!</span> If you associate several actions to the same shortcut, beware to avoid ambiguities by giving them mutually exclusive conditions. Otherwise, an error message will appear when you close the window. For example, if you want to associate <kbd>Ctrl + X</kbd> to Notepad when <kbd>Num Lock</kbd> is off and to the Calculator otherwise, you <i>must</i> give the condition “Num Lock: must be on” to the second shortcut. This is because “Num Lock: no condition” can be ambiguous with other shortcuts, such as <kbd>Ctrl + X</kbd> with the condition “Caps Lock: must be on”.</p>


<h3>Active program</h3>

<p>You can restrict a shortcut to some programs. This allows to give different meanings to the same shortcut, depending of the active program. By defaults, shortcuts are enabled for “all programs but: <i>none</i>”, i.e. for all programs.</p>

<p>You can define two kinds of condition on the active program. The shortcut can be enabled for all programs, except specific ones (exclusive criteria), or only for specific programs (inclusive criteria). Choose the condition type in the <i>Activate for</i> combo box, after having selected your shortcut in the list.</p>

<p>To define the list of programs concerned by the condition, click the small sight on the right (white background). Then keep the left mouse button down, and move the sight to the window of the program you want to select (for example, the window of Word or Windows Explorer). The name of the program is written in the text box at the left of the sight. Repeat this operation for each program to add to the list.</p>

<p>When the programs list is empty, the shortcut is active for all programs. If it is not empty, the shortcut is active only for the specified programs.</p>

<p>For a given keystroke, you can define any count of shortcuts having a <i>only these programs</i> condition, if they refer to different programs. In all cases, you can only define one shortcut having an <i>all programs but</i> condition.</p>

<p>Shortcuts of type <i>only these programs</i> have the priority on <i>all programs but</i> shortcuts. If you associate the condition “only these programs: <kbd>notepad.exe</kbd>” to a first shortcut, and “all programs but: <i>none</i>” to a second shortcut, if both shortcuts have the same keystroke, and if you execute this keystroke in Notepad, the first shortcut will be executed, the second will be ignored.</p>


<h3>Toggle keys</h3>

<p>You can modify the action of a keyboard shortcut depending of the toggle keys state: <kbd>Caps Lock</kbd>, <kbd>Num Lock</kbd>, <kbd>Scroll Lock</kbd>. For example, you can create a keyboard shortcut active only in caps lock mode.</p>

<p>To specify the conditions, double-click the shortcut in the list. In the <i>Activation condition</i> area, set a condition for each toggle key. You can want the key to be enabled, or disabled, or not setting any condition.</p>


<h2 id="text">Text format</h2>

<p>In the <i>Write text</i> textbox, you can specify several kinds of actions:</p>


<h3>Typing text</h3>

<p>Simply write the text to be typed in the text area. The <i>Write a character</i> in the arrow menu allows to insert special characters unreachable from the keyboard.</p>


<h3>Simulating a keystroke</h3>

<p>Use the <i>Simulate a Keystroke</i> in the arrow menu to write the keystroke code. Typically, the code is the name of the keystroke between brackets, for example: <kbd>[Ctrl+O]</kbd>.</p>

<p>Note that simulating a keystroke allows to do many different actions, like manipulating the clipboard (with <kbd>Ctrl + C</kbd> and <kbd>Ctrl + V</kbd>) or executing menu commands (with <kbd>Alt + <i>letter</i></kbd>).</p>


<h3>Launching a program</h3>

<p>Use the <i>Launch a Program</i> command in the arrow menu, or write the command line to execute enclosed in double brackets. For example, to open a text file and move the cursor to its end:<br />
<kbd>[[notepad.exe C:\\TODO.txt]][][Ctrl+End]</kbd></p>

<p>This syntax allows to launch several programs with the same shortcut. For example, to launch Notepad and the calculator:<br />
<kbd>[[notepad.exe]][[calc.exe]]</kbd></p>

<p>The command line can contain <kbd>%</kbd> enclosed environment variables, like in <kbd>explorer.exe %WINDIR%</kbd> to open the explorer at Windows directory. The <kbd>%CLIPBOARD%</kbd> environment variable will contain the text currently stored in the clipboard. For example, to open the selected URL with Internet Explorer:<br />
<kbd>[Ctrl+C][][[iexplore.exe %CLIPBOARD%]]</kbd></p>


<h3>Making a pause</h3>

<p>If your shortcut executes several actions, it may be necessary to let each of them enough time to be executed. To make a pause, write a pair of brackets: <kbd>[]</kbd>. Clavier+ will wait for 100 milliseconds, then detect the new focused window.</p>

<p>This last point is crucial. If you simulate a keystroke that displays a new window (for example <kbd>Ctrl + O</kbd> which pops out the <i>File/Open</i> dialog box), then write some text (for example a filename), you must indicate to Clavier+ that the text should be typed in the <em>new</em> window:<br />
<kbd>[Ctrl+O][]MyFile.txt[RETURN]</kbd></p>

<p>Do the same if you launch a program that displays a window: you should indicate to Clavier+ to detect the new active window.<br />
<kbd>[Ctrl+C][[notepad.exe]][][Ctrl+V]</kbd><br />
This shortcut copies to the clipboard the text currently selected, launches notepad, then pastes the copied text in it. The <kbd>[]</kbd> tag is crucial; it orders Clavier+ to paste to the <em>new</em> active window, i.e. notepad.</p>


<h3>Executing special commands</h3>

<p>The arrow menu contains the list of supported commands.</p>

<dl>
<dt><kbd>[{Wait,<i>duration</i>}]</kbd></dt>
<dd>Make a pause of the following duration, specified in milliseconds.</dd>

<dt><kbd>[{Focus}]</kbd></dt>
<dd>Detect the new active window. Useful if a keystroke displays a new window in which the shortcut needs to write. The <kbd>[]</kbd> command is often better, because it also waits a little to let the window a little time to appear.</dd>

<dt><kbd>[{Copy,<i>text</i>}]</kbd></dt>
<dd>Copy the specified text to the clipboard. Beware that this command is completely unrelated to the <kbd>Ctrl + C</kbd> clipboard shortcut, because this shortcut copies the <i>selection</i> to the clipboard. Associated to the <kbd>Ctrl + V</kbd> keystroke, this command allows to write a long text quickly, or to write many times the same text. The following example writes five time the same text:<br />
<kbd>[{Copy,A sentence to repeat five times. }][Ctrl+V][Ctrl+V][Ctrl+V][Ctrl+V][Ctrl+V]</kbd></dd>

<dt><kbd>[{MouseButton,<i>code</i>}]</kbd></dt>
<dd>Simulate a mouse button action. <i>code</i> specifies the button to modify and its new state. It is made of one or two letters.  The first one, mandatory, specifies the button to action: <kbd>L</kbd> = left button, <kbd>M</kbd> = middle button, <kbd>R</kbd> = right button. The second letter, optional, indicates the action to perform: <kbd>D</kbd> = press the button down, <kbd>U</kbd> = release the button up. If the second letter is not specified, the button is pressed then released: this simulates a click. For example, to simulate a double-click with the left mouse button:<br />
<kbd>[{MouseButton,L}][{MouseButton,L}]</kbd></dd>

<dt><kbd>[{MouseWheel,<i>ticks</i>}]</kbd></dt>
<dd>Simulate an action with the mouse wheel. <i>ticks</i> specifies the number of ticks to simulate. A positive value will scroll downwards, a negative one will scroll upwards. For example, to scroll once upwards:<br />
<kbd>[{MouseWheel,-1}]</kbd></dd>
</dl>


<h3>Special characters</h3>

<p>If you need to write special characters <kbd>[</kbd>, <kbd>]</kbd>, <kbd>{</kbd>, <kbd>}</kbd> or <kbd>|</kbd>, you need to escape them with a backslash. For example: <br />
<kbd>This is a bracket: \[, this is a single backslash: \\</kbd><br />
The arrow menu recalls the special characters list.</p>

<p>You should write a backslash before special character everywhere in the shortcut text, even in special tags such as keystroke simulation or program launching tags:<br />
<kbd>[[notepad.exe document\[1\].txt]]</kbd> to open the file named <kbd>document[1].txt</kbd> with Notepad</p>


<h2 id="print">Printing the shortcuts list</h2>

<p>In the main window of Clavier+, click on <i>Copy list</i> button. This puts the list of all keyboard shortcuts in the clipboard: you can past it in the word processor of your choice to print it. If you use Word, you can present it as an array: launch Word, copy the list with <kbd>Ctrl + V</kbd>, select it with <kbd>Ctrl + A</kbd>, and click the <i>Insert array</i> button.</p>


<h2 id="conffile">Configuration files</h2>

<p>By default, Clavier+ uses a single configuration file to store its settings: <kbd>Clavier.ini</kbd>, located in the same directory than Clavier+ main executable. Clavier+ doesn’t put anything in the registry, except if you use the <i>Launch Clavier+ at Windows startup</i> option.</p>

<p>Clavier+ menu, displayed by right clicking Clavier+ icon near the system clock, proposes several commands to manage configuration files:</p>
<ul>
<li>Available configuration files: <kbd>*.ini</kbd> files located in Clavier+ directory. Choose a file to load it.</li>
<li>Load Configuration: load a configuration file, if it is not in the list. Make sure not to load the configuration file of another program, it would be overwritten and lost.</li>
<li>Merge Configuration With: merge a configuration file with the current one. Shortcuts creating conflicts or ambiguities with the current shortcuts will not be added. In particular, the existing shortcuts will not be overwritten.</li>
<li>Save Configuration: save the current shortcuts to a new configuration file.</li>
</ul>

<p>Another way to load a configuration file is to run Clavier+ with the <kbd>/load</kbd> or <kbd>/merge</kbd> <a href="#cmdline">command line</a> option. This allows to load a configuration file with a keystroke, by associating a keyboard shortcut to the command line:</p>
<pre>clavier.exe /load <i>configuration_file.ini</i></pre>


<h3>Configuration files syntax</h3>

<p>If you need to add many shortcuts at once, here is the configuration file format</p>

<pre>
Global settings
First shortcut settings
-       (line almost empty: contains only a single dash)
Second shortcut settings
-
...
</pre>


<h4>Global settings</h4>

<pre>
Language=Français <i>or</i> English <i>or</i> Deutsch <i>or</i> Português brasileiro
Size=<i>width</i>,<i>height</i>,<i>maximized</i>,<i>hide icon</i>
Columns=<i>width 1</i>,<i>width 2</i>,<i>width 3</i>
Sorting=<i>column index</i>
</pre>

<dl>
<dt><kbd>Size</kbd></dt>
<dd><kbd>width,height</kbd>: size of the configuration window, in pixels.<br />
<kbd>maximized</kbd>: 1 if the window is maximized, 0 otherwise.<br />
<kbd>hide icon</kbd>: 1 to hide Clavier+ icon in the tray bar, near the system clock, 0 to keep it visible.
</dd>

<dt><kbd>Columns</kbd></dt>
<dd>Specifies the width of the first three columns in the configuration window. Each width is a percentage relative to the list width. The last column takes the remaining space.</dd>

<dt><kbd>Sorting</kbd></dt>
<dd>Specifies the index of the column used to sort the list. 0 for the first column, 1 for the second one, and so on.</dd>
</dl>


<h4>Shortcuts settings</h4>

<pre>
Shortcut=<i>keystroke</i>
Code=<i>keystroke code</i> (internally used by Clavier+)
DistinguishLeftRight=<i>0 or 1</i>
Description=<i>description text</i>
Text=<i>text to type when the shortcut is done</i>
&gt;<i>Other line to type</i>
&gt;<i>Another line</i>
...
Command=<i>program to launch when the shortcut is done</i>
Directory=<i>startup directory</i>
Window=<i>window mode of the program to launch</i>
SupportFileOpen=<i>0 or 1</i>
Programs=<i>programs list</i>
AllProgramsBut=<i>programs list</i>
CapsLock=<i>condition</i>
NumLock=<i>condition</i>
ScrollLock=<i>condition</i>
</pre>

<p>Note the necessity to type a <kbd>&gt;</kbd> character at the beginning of additional lines for the <kbd>Text=</kbd> field.</p>

<p><kbd>Text</kbd> on a side, and <kbd>Command</kbd>, <kbd>Directory</kbd> and <kbd>Window</kbd> on the other side are mutually exclusive: a shortcut can’t write a text and execute a command line at the same time.</p>

<dl>
<dt><kbd>Shortcut</kbd></dt>
<dd>Textual form of the keystroke, in the same format than in the configuration window.</dd>

<dt><kbd>Code</kbd></dt>
<dd>Numerical representation of the keystroke, generated and used by Clavier+. This code is used only if the <kbd>Shortcut</kbd> field is erroneous.</dd>

<dt><kbd>DistinguishLeftRight</kbd></dt>
<dd>Specifies whether Clavier+ should distinguish between left-side and right-side specials keys. If this setting is 1, <kbd>Ctrl</kbd>, <kbd>Alt</kbd>, <kbd>Shift</kbd> and <kbd>Win</kbd> keys located at the left side of the keyboard are distinguished from their equivalent located at the right side. This allows to create more shortcuts. If this settings is 0 (default value), the side of the special keys is not relevant in the keystroke.</dd>

<dt><kbd>Directory</kbd> (command mode only)</dt>
<dd>Startup directory of the command. If none is given, Clavier+ uses the directory of the executable itself.</dd>

<dt><kbd>Window</kbd> (command mode only)</dt>
<dd>Initial size of the main window of the launched program, among: <kbd>Normal</kbd>, <kbd>Minimized</kbd>, <kbd>Maximized</kbd>.</dd>

<dt><kbd>SupportFileOpen</kbd> (command mode only)</dt>
<dd>If the command is the path of a directory, specifies whether Clavier+ should detect File/Open dialog boxes to change their current directory (value 1). If the detection fails, or if this settings is 0 (default value), the directory is opened in Windows Explorer.</dd>

<dt><kbd>Programs</kbd>, <kbd>AllProgramsBut</kbd></dt>
<dd>Activation condition: list of the only programs for which the shortcut is activated (<kbd>Programs</kbd>) or disabled (<kbd>AllProgramsBut</kbd>). The programs are semi-colon-separated. They don’t have a full path: file name only, with extension.</dd>

<dt><kbd>CapsLock</kbd>, <kbd>NumLock</kbd>, <kbd>ScrollLock</kbd></dt>
<dd>If specified, specify an activation condition to the shortcut. Accepted values: <kbd>None</kbd> (default value), <kbd>Yes</kbd> and <kbd>No</kbd>.</dd>
</dl>


<h2 id="cmdline">Command line options</h2>

<p>Clavier+ accepts the following command line options:</p>

<dl>
<dt><kbd>/launch</i></kbd></dt>
<dd>Launch Clavier+, if necessary, and let it execute in background. The settings window is not displayed.</kbd></dd>

<dt><kbd>/settings</i></kbd></dt>
<dd>Launch Clavier+ in background, if necessary, and display the settings window.</kbd></dd>

<dt><kbd>/menu</i></kbd></dt>
<dd>Launch Clavier+ in background, if necessary, then display Clavier+ menu. The menu can be displayed manually by right clicking Clavier+ icon near the system clock.</dd>

<dt><kbd>/quit</i></kbd></dt>
<dd>Quit Clavier+, silently. If Clavier+ is not launched, do nothing.</dd>

<dt><kbd>/addtext</i></kbd></dt>
<dd>Display the window for adding a text shortcut. If necessary, launch Clavier+ in background and display the settings window.</dd>

<dt><kbd>/addcommand</i></kbd></dt>
<dd>Display the window for adding a program launching shortcut. If necessary, launch Clavier+ in background and display the settings window.</dd>

<dt><kbd>/load <i>configuration_file.ini</i></kbd></dt>
<dd>If Clavier+ is not already launched, launch it and load the given configuration file. If Clavier+ is already launched, do not launch it again but change the configuration file of the current instance of Clavier+. Enclose the filename in quotes if it contains spaces, for example: <kbd>clavier.exe /load "Internet shortcuts.ini"</kbd></dd>

<dt><kbd>/merge <i>configuration_file.ini</i></kbd></dt>
<dd>If Clavier+ is not already launched, launch it and merge the default configuration file (or the one specified by <kbd>/load</kbd>, if any), with the given configuration file. If Clavier+ is already launched, merge the configuration file of the current Clavier+ instance with the given configuration file. Merged shortcuts creating conflicts or ambiguities with the current shortcuts will not be added.</dd>

<dt><kbd>/sendkeys "<i>text</i>"</kbd></dt>
<dd>Simulate text typing. The text follows the <a href="#text">syntax specified above</a>. This options allows, for example, to type text when double-clicking on a Windows shortcut, or at Windows startup, or when choosing a command in Explorer context menu. Quotes and backslashes must be escaped by a backslash, for example: <kbd>clavier.exe /sendkeys "Write a \"quoted\" word and a single \\ backslash"</kbd></dd>
</dl>

<p>If Clavier+ is launched without any argument, the behavior depends of whether Clavier+ is already launched. If no, launch Clavier+ silentely. If yes, do not launch Clavier+ again but display the configuration window. This allows to access Clavier+ options even if its icon is hidden.</p>


<h2 id="limits">Known issues</h2>

<h3>Unavailable shortcuts</h3>

<p>Some special keys can’t be used:</p>
<pre>
Print Screen
Pause
</pre>

<p>The special keys “Refresh browser”, “increase volume”, etc. are partially supported. Shortcuts using them can be created, and it is possible to modify their original behavior. However the action of these keys is executed when they are pressed in the <i>Add</i> dialog box. Moreover, as Windows does not provide a generic method to get the name of theses special keys, they are named by a number (for example: <kbd>#183</kbd>).</p>

<p>Windows standard shortcuts cannot be modified. Here are some of them:</p>

<table><colgroup><col width="30%"/><col/></colgroup>
<tr><td><kbd>Ctrl + Alt + DEL</kbd></td><td>display task manager</td></tr>
<tr><td><kbd>F12</kbd></td><td>reserved to the debugger</td></tr>
<tr><td><kbd>Alt + Tab</kbd></td><td>activate the next task</td></tr>
<tr><td><kbd>Alt + Shift + Tab</kbd></td><td>activate the previous task</td></tr>
<tr><td><kbd>Win + B</kbd></td><td>activate the focus in the traybar</td></tr>
<tr><td><kbd>Win + D</kbd></td><td>reduce all windows; do it twice to restore the previous state</td></tr>
<tr><td><kbd>Win + E</kbd></td><td>launch the explorer</td></tr>
<tr><td><kbd>Win + F</kbd></td><td>show the <i>Find files</i> window</td></tr>
<tr><td><kbd>Win + Ctrl + F</kbd></td><td>show the <i>Find computers</i></td></tr>
<tr><td><kbd>Win + L</kbd></td><td>fast user switching (Windows XP)</td></tr>
<tr><td><kbd>Win + M</kbd></td><td>reduce all windows</td></tr>
<tr><td><kbd>Win + Shift + M</kbd></td><td>cancel the effect of Win + M</td></tr>
<tr><td><kbd>Win + R</kbd></td><td>show Start/Execute window</td></tr>
<tr><td><kbd>Win + U</kbd></td><td>launch the utilities manager</td></tr>
<tr><td><kbd>Win + F1</kbd></td><td>launch Windows help</td></tr>
<tr><td><kbd>Win + Tab</kbd></td><td>activate the next taskbar button</td></tr>
<tr><td><kbd>Win + Shift + Tab</kbd></td><td>activate the previous taskbar </td></tr>
<tr><td><kbd>Win + Pause</kbd></td><td>show the <i>System</i> applet of the configuration panel</td></tr>
</table>


<h3>Shortcuts having side effects</h3>

<p>By default under Windows, the <kbd>Alt + Shift</kbd> shortcut changes the keyboard layout. You are strongly encouraged not to use shortcuts like <kbd>Alt + Shift + <i>key</i></kbd>, because you could change the keyboard layout by mistake.</p>


<h3>Partially incompatible programs</h3>

<p>Clavier+ may encounter difficulty with some programs when typing text or simulating keystrokes:</p>
<ul>
<li>Some cross-platform programs, which do not respect Windows standard in matter of keyboard handling. It concerns <b>Java</b> programs like <b>OpenOffice</b>, Mozilla software (<b>Firefox</b>, <b>Thunderbird</b>), <b>Opera</b>, etc. If a problem occurs in one of those programs, use the <kbd>[|<i>text</i>|]</kbd> syntax to make Clavier+ using low-level techniques when typing text (better compatibility, but slower and more limited).</li>
<li><b>Games</b>, because they bypass Windows, thus Clavier+, when handling the keyboard.</li>
<li>System programs, because they bypass Windows too. For example: <kbd>command.com</kbd>, emulators and virtual machines (Cygwin, VirtualPC), virtualizers (VNC).</li>
</ul>


<h2 id="faq">FAQ</h2>

<p>You can access the last version of this FAQ in <a href="http://utilfr42.free.fr/util/Clavier.php#faq">Clavier+ page</a>.</p>

<div class="faq-question">Clavier+ can’t write text in <i>MyFavoriteProgram</i>!</div><div class="faq-answer"><p>Some programs handle the keyboard in a non-standard way, disallowing Clavier+ to write text. To solve this problem, surround your text by <kbd>[|</kbd> and <kbd>|]</kbd>, as below:</p><p><kbd>[|My text|]</kbd></p></div><div class="faq-question">Does Clavier+ works in games?</div><div class="faq-answer"><p>Most of the time, no. Games access the keyboard in low-level, for various raisons (rapidity, cheat protection, …).</p></div><div class="faq-question">I use Clavier+ to write my passwords. How to protect Clavier+ with a password?</div><div class="faq-answer"><p>Clavier+ is not designed to store passwords. At most, under Windows XP Professional, you can encrypt the <kbd>Clavier.ini</kbd> file and hide Clavier+ icon (see below). However I strongly recommand using a program dedicated to passwords storing, like <a href="http://keepass.sourceforge.net/">KeePass</a> or <a href="http://passwordsafe.sourceforge.net/">Password Safe</a>.</p></div><div class="faq-question">How to make the numpad dot key write a comma?</div><div class="faq-answer"><p>Click the plus shaped button, choose <i>Write Text</i>, press the numpad dot key, then click the <i>OK</i> button. Write a comma in the <i>Write text</i> area.</p></div><div class="faq-question">How to create a shortcut to a special folder: My computer, Control panel, …?</div><div class="faq-answer"><p>In Windows Explorer, create a Windows shortcut to the special folder: press the right mouse button on the special folder, drag the mouse to another folder (for example <kbd>C:\</kbd>), release the buton and choose <i>Create shortcut here</i> in the popup menu.</p><p>Then, in Clavier+, create a <i>Launch a program</i> keyboard shortcut that executes the Windows shortcut you have just created. You have to write the full path manually, and to append the <kbd>.lnk</kbd> extension. For example: <kbd>C:\My computer.lnk</kbd> if you have created a shortcut named <kbd>My computer</kbd> in the folder <kbd>C:\</kbd>.</p></div><div class="faq-question">How to open a folder in Explorer and display the tree pane?</div><div class="faq-answer"><p>In the shortcut command line, insert <kbd>explorer /e,</kbd> before the folder path. For example: <kbd>explorer /e, C:\</kbd></p></div><div class="faq-question">How to remove Clavier+ icon from the traybar?</div><div class="faq-answer"><p>Launch Clavier+ then quit it. Double-click on the <kbd>Clavier.ini</kbd> file located in the same directory than Clavier+. In the second line, that begins with <kbd>Size=</kbd>, replace the <i>last</i> zero by the digit one. For example: <kbd>Size=923,501,0,0</kbd> should become <kbd>Size=923,501,0,1</kbd>.</p><p>As Clavier+ icon will no more be visible, you will have to launch Clavier+ twice to display its configuration window (once to launch it, once to display the window).</p></div><div class="faq-question">How to write a line return with a shortcut?</div><div class="faq-answer"><p>Two solutions:</p><ul><li>insert a line return in the edit box, by pressing the <kbd>Return</kbd> key,</li><li>if the previous solution doesn’t work, write the code <kbd>[RETURN]</kbd></li></ul></div><div class="faq-question">How to simulate the key <i>Dummy</i></div><div class="faq-answer"><p>Click the arrow-shape button, choose the command <i>Simulate a Keystroke</i>.</p></div><div class="faq-question">How to display the context menu?</div><div class="faq-answer"><p>Simulating the key <i>Context Menu</i> allows to display this menu. With the command <i>Simulate a Keystroke</i> in the arrow-shaped button, we can learn that the code of this key is <kbd>#93</kbd>. Thus, writing <kbd>[#93]</kbd> allows to display the context menu. To display the context menu at the position of the mouse cursor, simulate a right-click with: <kbd>[{MouseButton,R}]</kbd></p></div><div class="faq-question">How to change the sound volume?</div><div class="faq-answer"><p>There is three keys related to sound volume:</p><ul><li>mute: code <kbd>[#173]</kbd></li><li>higher volume: code <kbd>[#175]</kbd></li><li>lower volume: code <kbd>[#174]</kbd></li></ul><p>You can use the program <a href="http://localhost/utilfr/dn/VolumeManager.exe">VolumeManager</a> to adjust the volume finely.</p></div><div class="faq-question">The checkbox <i>Launch Clavier+ at Windows startup</i> doesn’t work!</div><div class="faq-answer"><p>Create a shortcut to <kbd>Clavier.exe</kbd> in <i>Start Menu/Programs/Startup</i>. To do this, click with the right button on <kbd>Clavier.exe</kbd>, keep the button down and drag the mouse to the Start menu, then <i>Programs</i>, then <i>Startup</i>, and release the mouse button. Choose <i>Create a shortcut here</i>.</p></div><div class="faq-question">How to launch two programs at once?</div><div class="faq-answer"><p>The solution is to enclose the path of the two programs in double brackets, in the <kbd>Write text</kbd> area. For example, to launch notepad and the calculator:</p><pre>[[notepad.exe]][[calc.exe]]</pre></div><div class="faq-question">How to simulate a mouse click, a double-click, a right click?</div><div class="faq-answer"><p>You need to create a shortcut of type <i>Write text</i> and use the <kbd>[{MouseButton,<i>code</i>}]</kbd> special command. For example, to simulate a left click: <kbd>[{MouseButton,L}]</kbd>. For a double-click, execute two left clicks: <kbd>[{MouseButton,L}][{MouseButton,L}]</kbd>. For a right click, use the <kbd>R</kbd> code: <kbd>[{MouseButton,R}]</kbd>.</p></div><div class="faq-question">How to do more complicated things: write the current date, activate an application, …?</div><div class="faq-answer"><p>You can create a VBScript program and ask Clavier+ to execute it. The generic procedure is the following: launch Notepad, write the text of your script, save it with the <kbd>.VBS</kbd> file extension, then associate a shortcut to it with Clavier+.</p><p>Some examples of scripts:</p><ul><li>Write the current date in the active program:<pre>set shell = WScript.CreateObject("WScript.Shell")<br />shell.SendKeys Date()</pre></li><li>Activate an application and send keystrokes to it, for example compute 2+7 with the calculator (which should be already launched):<pre>set shell = WScript.CreateObject("WScript.Shell")<br />shell.AppActivate "Calculator"<br />WScript.Sleep(100)<br />shell.SendKeys "2{+}"<br />WScript.Sleep(100)<br />shell.SendKeys "7{=}"</pre><p>Please read the <a href="http://msdn.microsoft.com/archive/default.asp?url=/archive/en-us/wsh/htm/wsMthSendKeys.asp">Microsoft documentation</a> for more information about the available keystrokes in VBScript.</p></li></ul></div>


<h2 id="examples">Shortcuts examples</h2>

<ul><li>Create a new folder in Windows Explorer<br />text <kbd>[#93][N][RETURN]</kbd> with the program condition <kbd>explorer.exe</kbd></li><li>Execute the <i>File</i>/<i>Quit</i> menu command<br />text <kbd>[Alt+F4]</kbd> or text <kbd>[Alt+F][Q]</kbd></li><li>Translate to French the selected word with an online dictionnary<br />text <kbd>[Ctrl+C][[http://www.wordreference.com/enfr/%CLIPBOARD%]]</kbd></li><li>Write an e-mail<br />command <kbd>mailto:</kbd> or <kbd>mailto:somebody@domain.com&amp;subject=Subject</kbd></li><li>Scroll the active program 3 lines downward<br />text <kbd>[{MouseWheel,3}]</kbd></li><li>Display the control panel<br />command <kbd>control.exe</kbd></li><li>Higher or lower the volume<br />text <kbd>[#175]</kbd> or text <kbd>[#174]</kbd></li><li>Paste the selection to Notepad<br />text <kbd>[Ctrl+C][[notepad.exe]][][Ctrl+V]</kbd></li><li>Fill a form<br />text <kbd>first field[TAB]second field[TAB]third field[ENTER]</kbd></li><li>Shutdown Windows<br />command <kbd>shutdown.exe -s -t 01</kbd></li><li>Restart Windows<br />command <kbd>shutdown.exe -r -t 01</kbd></li><li>Logout<br />command <kbd>shutdown.exe -l</kbd></li></ul>

</body>
</html>
