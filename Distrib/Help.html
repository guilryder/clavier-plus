<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252"/>
<title>Clavier+ help</title>
<link rel="stylesheet" type="text/css" href="ClavierHelp.css"/>
</head>

<body>

<h1>Clavier+ help</h1>

<p class="toc">
<a href="#name">Why such a strange name?</a>
<a href="#author">Author</a>
<a href="#license">License</a>
<a href="#setup">Setup</a>
<a href="#utility">What can Clavier+ do</a>
<a href="#add">Create a keyboard shortcut</a>
<a href="#conditions">Conditions applied to the shortcuts</a>
<a href="#text">Actions of a text shortcut</a>
<a href="#print">Printing the shortcuts list</a>
<a href="#conffile">Configuration files</a>
<a href="#cmdline">Command line options</a>
<a href="#limits">Known issues</a>
<a href="#faq">FAQ</a>
<a href="#examples">Shortcuts examples</a>
</p>


<h2 style="clear: both"><a href="http://utilfr42.free.fr/util/Clavier.php">Clavier+ website</a></h2>


<h2 id="name">Why such a strange name?</h2>

<p><i>Clavier</i> simply is the French word for <i>keyboard</i>. Note the incredible originality of this name, and the amount of creativity deployed to find it!</p>


<h2 id="author">Author</h2>

<p>Guillaume Ryder<br/>
Website: <a href="http://utilfr42.free.fr/"><kbd>http://utilfr42.free.fr</kbd></a><br/>
E-mail: <a href="mailto:guillaume@ryder.fr"><kbd>guillaume@ryder.fr</kbd></a>
</p>


<h2 id="license">License</h2>

<p>Clavier+ is released under the <a href="http://www.gnu.org/copyleft/gpl.html">GPL license</a>. This gives you the right to use, copy, distribute the software, for any use (personal or commercial), all that without having to pay anything.</p>

<p>There is no warranty for this program, I’m not responsible of any damage due to its use.</p>

<p>The full source code of Clavier+ is available here:<br/>
<a href="https://code.google.com/p/clavier-plus/source/browse/"><kbd>https://code.google.com/p/clavier-plus/source/browse/</kbd></a></p>


<h2 id="setup">Setup</h2>

<p>Clavier+ is distributed in four versions:</p>
<ul>
<li><b>With</b> setup program, 32 and 64 bits: <a href="http://utilfr42.free.fr/dn/ClavierSetup32.exe"><kbd>http://utilfr42.free.fr/dn/ClavierSetup32.exe</kbd></a>, <a href="http://utilfr42.free.fr/dn/ClavierSetup64.exe"><kbd>http://utilfr42.free.fr/dn/ClavierSetup64.exe</kbd></a></li>
<li><b>Without</b> setup program, 32 and 64 bits: <a href="http://utilfr42.free.fr/dn/Clavier32.zip"><kbd>http://utilfr42.free.fr/dn/Clavier32.zip</kbd></a>, <a href="http://utilfr42.free.fr/dn/Clavier64.zip"><kbd>http://utilfr42.free.fr/dn/Clavier64.zip</kbd></a></li>
</ul>

<p>To install Clavier+ without setup program:</p>
<ol>
<li>Download the Zip archive (<a href="http://utilfr42.free.fr/dn/Clavier32.zip">32 bits</a>, <a href="http://utilfr42.free.fr/dn/Clavier64.zip">64 bits</a>) and unzip it.</li>
<li>Launch <kbd>Clavier.exe</kbd>.</li>
<li>If you want the shortcuts to be always active, launch <kbd>Clavier.exe</kbd> again to display the configuration dialog box, then check the <i>Launch Clavier+ at Windows startup</i> checkbox.</li>
</ol>

<p>To uninstall Clavier+ without setup program:</p>
<ol>
<li>In Clavier+ configuration, uncheck the <i>Launch Clavier+ at Windows startup</i> checkbox, if necessary.</li>
<li>Quit Clavier+ by clicking the button having this name.</li>
<li>Delete all Clavier+ files.</li>
</ol>


<h2 id="utility">What can Clavier+ do</h2>

<p>Clavier allows to associate an action to any keyboard shortcut. Those actions can be:</p>
<ul>
<li>launch a program: Word, calculator, Internet browser, etc.</li>
<li>display a website</li>
<li>open a folder: <i>My documents</i>, <kbd>C:</kbd>, CD-Rom drive, etc.</li>
<li>write special characters: ® and © symbols, currency symbols like € or ¥, etc.</li>
<li>write text: E-mail address, company name, etc. in any program (Word, Internet browser, notepad)</li>
<li>simulate keystrokes, for example to execute a command in the menus of a program</li>
<li>simulate mouse moves and clicks or mouse wheel action</li>
</ul>

<p>The keyboard shortcuts can use (almost) any key of the keyboard. The Windows key, located around the spacebar, can be used along with Ctrl, Alt and Shift. As programs rarely use this key, many simple keyboard shortcuts are available to you: <kbd>Win + A</kbd>, <kbd>Win + 2</kbd>, <kbd>Win + .</kbd>, etc.</p>

<p>Clavier+ can modify the behavior of special keys like <kbd>`</kbd> or <kbd>F11</kbd>. Thus a keyboard shortcut of one single key can be associated to a frequently used action.</p>

<p>If necessary, the action of a keyboard shortcut can depend of the active program. This allows to add shortcuts to a specific program.</p>

<p>In the same way, the action of a keyboard shortcut can depend of the state of the toggle keys, i.e. the keys having small lights in the keyboard: Caps Lock, Num Lock, Scroll Lock. For example, this allows to write special characters instead of digits when the caps lock mode is set.</p>

<p>Clavier+ website proposes <a href="http://utilfr42.free.fr/util/Clavier.php#examples">some shortcuts examples</a>.</p>


<h2 id="add">Create a keyboard shortcut</h2>

<p>Launch Clavier+. A small keyboard icon appears in the traybar, near the system clock. It indicates that Clavier+ is running, thus keyboard shortcuts are active. Click the icon to display the configuration window. You can resize the window if you find it too small. The upper area contains some example shortcuts.</p>

<p>To create a new keyboard shortcut, click the <i>Add</i> button (having the shape of a + symbol), and choose the keyboard shortcut action:</p>
<ul>
<li><b>Program:</b> execute a program of the Start menu</li>
<li><b>Internet Favorite:</b> display a website contained in the favorites of Internet Explorer (if you use another Web browser, for example Firefox, chose <i>Display a Website</i> below)</li>
<li><b>Special Character:</b> write a special character</li>
<li><b>Folder:</b> open a folder with Windows Explorer</li>
<li><b>Write text:</b> simulate text writing, and eventually simulate keystrokes (for example the <kbd>Tab</kbd> key to fill all fields of a form at once)</li>
<li><b>Launch a Program</b>: launch a program missing in the Start menu, or execute any command line</li>
<li><b>Display a Website</b>: display a website missing in Internet Explorer favorites</li>
</ul>

<p>A dialog box appears for you to specify the keyboard shortcut. Type it in the dedicated area: its text name should be written in the textbox. Then, click the <i>OK</i> button.</p>

<p>If necessary, modify the shortcut action in the lower part of the configuration window. If the shortcut should write text, for example an E-mail address, check that the <i>Write text</i> option is checked, then enter your text in the big text area. Each time you will type the keyboard shortcut, the specified text will be written. You can use the arrow menu to insert special characters or simulate a keystroke.</p>

<p>If the shortcut should launch a program or display a website, check the matching option. Write the path of your program or the address of your website in the area below. You can use the small button on the right to look for the program to launch. You can check the action of your shortcut by clicking the <i>Test</i> button. If necessary, click the <i>Advanced settings</i> button to specify the initial directory or the initial window size of the program (maximized, windowed, minimized).</p>

<p>If the shortcut opens a directory, you can allow it to change the current directory in <i>File/Open</i> dialog boxes. To do this, click the <i>Advanced settings</i> button and check <i>Change directory in File/Open dialog boxes</i>. When you execute the shortcut keystroke, Clavier+ detects whether you are in a File/Open dialog box or not. If yes, the current directory of the dialog box is changed, and the directory is not opened in Windows Explorer. Clavier+ supports several dialog boxes: File/Open, File/Save as, and directory choosing.</p>

<p><span class="ipt">Important:</span> you should close Clavier+ configuration window <i>before</i> testing your shortcuts. While the window is visible, the keyboard shortcuts are disabled.</p>


<h2 id="conditions">Conditions applied to the shortcuts</h2>

<p>You can restrict the effect of a shortcut to some conditions. If all conditions fulfill, the action of the shortcut is executed. If one or more conditions do not fulfill, Clavier+ ignores the shortcut, and the original action of the shortcut is executed (the one defined by Windows or the active program). This allows to associate different actions to the same shortcut.</p>

<p><span class="ipt">Warning!</span> If you associate several actions to the same shortcut, beware to avoid ambiguities by giving them mutually exclusive conditions. Otherwise, an error message will appear when you close the window. For example, if you want to associate <kbd>Ctrl + X</kbd> to Notepad when <kbd>Num Lock</kbd> is off and to the Calculator otherwise, you <i>must</i> give the condition “Num Lock: must be on” to the second shortcut. This is because “Num Lock: no condition” can be ambiguous with other shortcuts, such as <kbd>Ctrl + X</kbd> with the condition “Caps Lock: must be on”.</p>


<h3>Active program</h3>

<p>You can restrict a shortcut to some programs. This allows to give different meanings to the same shortcut, depending of the active program. By defaults, shortcuts are enabled for “all programs but: <i>none</i>”, i.e. for all programs.</p>

<p>You can define two kinds of condition on the active program. The shortcut can be enabled for all programs, except specific ones (exclusive criteria), or only for specific programs (inclusive criteria). Choose the condition type in the <i>Activate for</i> combo box, after having selected your shortcut in the list.</p>

<p>To define the list of programs concerned by the condition, click the small sight on the right (white background). Then keep the left mouse button down, and move the sight to the window of the program you want to select (for example, the window of Word or Windows Explorer). The name of the program is written in the text box at the left of the sight. Repeat this operation for each program to add to the list.</p>

<p>When the programs list is empty, the shortcut is active for all programs. If it is not empty, the shortcut is active only for the specified programs.</p>

<p>For a given keystroke, you can define any count of shortcuts having an <i>only these programs</i> condition, if they refer to different programs. In all cases, you can only define one shortcut having an <i>all programs but</i> condition.</p>

<p>Shortcuts of type <i>only these programs</i> have the priority on <i>all programs but</i> shortcuts. If you associate the condition “only these programs: <kbd>notepad.exe</kbd>” to a first shortcut, and “all programs but: <i>none</i>” to a second shortcut, if both shortcuts have the same keystroke, and if you execute this keystroke in Notepad, the first shortcut will be executed, the second will be ignored.</p>


<h3>Toggle keys</h3>

<p>You can modify the action of a keyboard shortcut depending of the toggle keys state: <kbd>Caps Lock</kbd>, <kbd>Num Lock</kbd>, <kbd>Scroll Lock</kbd>. For example, you can create a keyboard shortcut active only in caps lock mode.</p>

<p>To specify the conditions, double-click the shortcut in the list. In the <i>Activation condition</i> area, set a condition for each toggle key. You can want the key to be enabled, or disabled, or not setting any condition.</p>


<h2 id="text">Actions of a text shortcut</h2>

<p>In the <i>Write text</i> textbox, you can specify several kinds of actions:</p>


<h3>Typing text</h3>

<p>Simply write the text to be typed in the text area. The <i>Write a character</i> in the arrow menu allows to insert special characters unreachable from the keyboard.</p>

<p>Typing text does not work with some programs. You can try to use the <kbd>[|<i>text to write</i>|]</kbd> syntax to make Clavier+ using low-level techniques when typing text (better compatibility, but slower and more limited).</p>

<h3>Simulating a keystroke</h3>

<p>Use the <i>Simulate a Keystroke</i> in the arrow menu to write the keystroke code. Typically, the code is the name of the keystroke between brackets, for example: <kbd>[Ctrl+O]</kbd>.</p>

<p>Note that simulating a keystroke allows to do many different actions, like manipulating the clipboard (with <kbd>Ctrl + C</kbd> and <kbd>Ctrl + V</kbd>) or executing menu commands (with <kbd>Alt + <i>letter</i></kbd>).</p>


<h3>Launching a program</h3>

<p>Use the <i>Launch a Program</i> command in the arrow menu, or write the command line to execute enclosed in double brackets. For example, to open a text file and move the cursor to its end:<br/>
<kbd>[[notepad.exe C:\\TODO.txt]][][Ctrl+End]</kbd></p>

<p>This syntax allows to launch several programs with the same shortcut. For example, to launch Notepad and the calculator:<br/>
<kbd>[[notepad.exe]][[calc.exe]]</kbd></p>

<p>The command line can contain <kbd>%</kbd> enclosed environment variables, like in <kbd>explorer.exe %WINDIR%</kbd> to open the explorer at Windows directory. The <kbd>%CLIPBOARD%</kbd> environment variable will contain the text currently stored in the clipboard. For example, to open the selected URL with Internet Explorer:<br/>
<kbd>[Ctrl+C][][[iexplore.exe %CLIPBOARD%]]</kbd></p>


<h3>Synchronizing</h3>

<p>If your shortcut executes several actions, it may be necessary to let each of them enough time to be executed. To make a pause, write a pair of brackets: <kbd>[]</kbd>. Clavier+ will wait for 100 milliseconds, then detect the new focused window. You can also use the command <a href="#focus"><kbd>[{Focus}]</kbd></a> to specify the delay.</p>

<p>This last point is crucial. If you simulate a keystroke that displays a new window (for example <kbd>Ctrl + O</kbd> which pops out the <i>File/Open</i> dialog box), then write some text (for example a filename), you must indicate to Clavier+ that the text should be typed in the <em>new</em> window:<br/>
<kbd>[Ctrl+O][]MyFile.txt[ENTER]</kbd></p>

<p>Do the same if you launch a program that displays a window: you should indicate to Clavier+ to detect the new active window.<br/>
<kbd>[Ctrl+C][[notepad.exe]][][Ctrl+V]</kbd><br/>
This shortcut copies to the clipboard the text currently selected, launches notepad, then pastes the copied text in it. The <kbd>[]</kbd> tag is crucial; it orders Clavier+ to paste to the <em>new</em> active window, i.e. notepad.</p>


<h3>Executing special commands</h3>

<p>The arrow menu contains the list of supported commands.</p>

<dl>
<dt><kbd>[{Wait,<i>duration</i>}]</kbd></dt>
<dd>Make a pause of the following duration, specified in milliseconds.</dd>

<dt><kbd id="focus">[{Focus,<i>delay</i>,<i>window name</i>}]</kbd></dt>
<dd><div>Detect or set the new active window. The <i>window name</i> and <i>delay</i> parameters are optional.</div>
<p>If not empty, <i>delay</i> is the number of milliseconds to wait before activating the window. It may be useful give enough time for the window to appear before trying to activate it. If <i>delay</i> is not specified, there is no delay.</p>
<p>If <i>window name</i> is empty, Clavier+ detects the new active window and will send the future keystrokes to it. Useful if a keystroke displays a new window in which the shortcut needs to write. Example:<br/>
<kbd>[{Focus}]</kbd> or <kbd>[{Focus,200}]</kbd></p>
<p>If <i>window name</i> is not empty, Clavier+ activates the first window matching the given name. The name can contain <kbd>*</kbd> and <kbd>?</kbd> wildcards. Backslashes should be used twice to escape commas. Example:<br/>
<kbd>[{Focus,50,* - Microsoft Word}]</kbd> or <kbd>[{Focus,,Title\\, subtitle}]</kbd></p>
<p>By default, the shortcut execution stops if the window is not found. In order to continue executing the shortcut even if the window is not found, insert an exclamation mark <kbd>!</kbd> before the window title. If you want to search for a window having a title beginning with <kbd>!</kbd>, escape it with two backslashes. Examples:<br/>
<kbd>[{Focus,0,*Internet Explorer}][Alt+F4]</kbd> closes the first Internet Explorer window found. Does nothing if Internet Explorer is not running.<br/>
<kbd>[{Focus,0,!Untitled*}]Test</kbd> writes <kbd>Test</kbd> in the window having a title beginning with <kbd>Untitled</kbd>, or in the current window if such a window does not exist.<br/>
<kbd>[{Focus,0,\\!Warning!}]</kbd> activates the first window titled with <kbd>!Warning!</kbd>.</p>
<p>Note that <kbd>[{Focus,100}]</kbd> is equivalent to <kbd>[]</kbd>.</p></dd>

<dt><kbd>[{Copy,<i>text</i>}]</kbd></dt>
<dd>Copy the specified text to the clipboard. Beware that this command is completely unrelated to the <kbd>Ctrl + C</kbd> clipboard shortcut, because this shortcut copies the <i>selection</i> to the clipboard. Associated to the <kbd>Ctrl + V</kbd> keystroke, this command allows to write a long text quickly, or to write many times the same text. The following example writes five time the same text:<br/>
<kbd>[{Copy,A sentence to repeat five times. }][Ctrl+V][Ctrl+V][Ctrl+V][Ctrl+V][Ctrl+V]</kbd></dd>

<dt><kbd>[{MouseButton,<i>code</i>}]</kbd></dt>
<dd>Simulate a mouse button action. <i>code</i> specifies the button to modify and its new state. It is made of one or two letters.  The first one, mandatory, specifies the button to action: <kbd>L</kbd> = left button, <kbd>M</kbd> = middle button, <kbd>R</kbd> = right button. The second letter, optional, indicates the action to perform: <kbd>D</kbd> = press the button down, <kbd>U</kbd> = release the button up. If the second letter is not specified, the button is pressed then released: this simulates a click. For example, to simulate a double-click with the left mouse button:<br/>
<kbd>[{MouseButton,L}][{MouseButton,L}]</kbd></dd>

<dt><kbd>[{MouseMoveTo,<i>x</i>,<i>y</i>}]</kbd></dt>
<dd>Move the mouse cursor to the given (x,y) position, specified in pixels relatively to the upper-left corner of the screen. For example, if you have a resolution resolution of 1,024 &times; 768, the following command will move the cursor to the upper right corner:<br/>
<kbd>[{MouseMoveTo,1023,0}]</kbd></dd>

<dt><kbd>[{MouseMoveToFocus,<i>x</i>,<i>y</i>}]</kbd></dt>
<dd>Move the mouse cursor to the given (x,y) position, specified in pixels relatively to the upper-left corner of the active window. For example, to move the mouse over the system menu if the active window:<br/>
<kbd>[{MouseMoveToFocus,8,8}]</kbd></dd>

<dt><kbd>[{MouseMoveBy,<i>dx</i>,<i>dy</i>}]</kbd></dt>
<dd>Move the mouse cursor by the given amount of pixels. For example, to move the mouse by 10 pixels left and 3 pixels down:<br/>
<kbd>[{MouseMoveBy,-10,3}]</kbd></dd>

<dt><kbd>[{MouseWheel,<i>ticks</i>}]</kbd></dt>
<dd>Simulate an action with the mouse wheel. <i>ticks</i> specifies the number of ticks to simulate. A positive value will scroll downwards, a negative one will scroll upwards. For example, to scroll twice upwards:<br/>
<kbd>[{MouseWheel,-2}]</kbd></dd>
</dl>


<h3>Special characters</h3>

<p>If you need to write special characters <kbd>\</kbd>, <kbd>[</kbd>, <kbd>]</kbd>, <kbd>{</kbd>, <kbd>}</kbd> or <kbd>|</kbd>, you need to escape them with a backslash. For example:<br/>
<kbd>This is a bracket: \[, this is a single backslash: \\</kbd><br/>
The arrow menu has an entry listing all special characters.</p>

<p>You should write a backslash before special character everywhere in the shortcut text, even in special tags such as keystroke simulation or program launching tags:<br/>
<kbd>[[notepad.exe document\[1\].txt]]</kbd> to open the file named <kbd>document[1].txt</kbd> with Notepad</p>


<h2 id="print">Printing the shortcuts list</h2>

<p>In the main window of Clavier+, click on <i>Copy list</i> button. This puts the list of all keyboard shortcuts in the clipboard: you can past it in the word processor of your choice to print it. If you use Word, you can present it as an array: launch Word, copy the list with <kbd>Ctrl + V</kbd>, select it with <kbd>Ctrl + A</kbd>, and click the <i>Insert array</i> button.</p>


<h2 id="conffile">Configuration files</h2>

<p>By default, Clavier+ uses a single configuration file to store its settings: <kbd>Clavier.ini</kbd>, located in the same directory than Clavier+ main executable. Clavier+ doesn’t put anything in the registry, except if you use the <i>Launch Clavier+ at Windows startup</i> option.</p>

<p>Clavier+ menu, displayed by right clicking Clavier+ icon near the system clock, proposes several commands to manage configuration files:</p>
<ul>
<li>Available configuration files: <kbd>*.ini</kbd> files located in Clavier+ directory. Choose a file to load it.</li>
<li>Load Configuration: load a configuration file, if it is not in the list. Make sure not to load the configuration file of another program, it would be overwritten and lost.</li>
<li>Merge Configuration With: merge a configuration file with the current one. Shortcuts creating conflicts or ambiguities with the current shortcuts will not be added. In particular, the existing shortcuts will not be overwritten.</li>
<li>Save Configuration: save the current shortcuts to a new configuration file.</li>
</ul>

<p>Another way to load a configuration file is to run Clavier+ with the <kbd>/load</kbd> or <kbd>/merge</kbd> <a href="#cmdline">command line</a> option. This allows to load a configuration file with a keystroke, by associating a keyboard shortcut to the command line:</p>
<pre>clavier.exe /load <i>configuration_file.ini</i></pre>


<h3>Configuration files syntax</h3>

<p>If you need to add many shortcuts at once, here is the configuration file format</p>

<pre>
Global settings
First shortcut settings
-       (line almost empty: contains only a single dash)
Second shortcut settings
-
...
</pre>

<p>If a configuration file contains multiple definitions for the same shortcut, Clavier+ retains only the first definition. The duplicate definitions coming next are ignored. Therefore if you want to override some of your shortcuts by copy-pasting new definitions, insert the new configuration at the beginning of the file, not at the end.</p>

<h4>Global settings</h4>

<pre>
Language=Français <i>or</i> English <i>or</i> Deutsch <i>or</i> Português brasileiro
Size=<i>width</i>,<i>height</i>,<i>maximized</i>,<i>hide icon</i>
Columns=<i>width 1</i>,<i>width 2</i>,<i>width 3</i>
Sorting=<i>column index</i>
</pre>

<dl>
<dt><kbd>Size</kbd></dt>
<dd><kbd>width,height</kbd>: size of the configuration window, in pixels.<br/>
<kbd>maximized</kbd>: 1 if the window is maximized, 0 otherwise.<br/>
<kbd>hide icon</kbd>: 1 to hide Clavier+ icon in the tray bar, near the system clock, 0 to keep it visible.
</dd>

<dt><kbd>Columns</kbd></dt>
<dd>Specifies the width of the first three columns in the configuration window. Each width is a percentage relative to the list width. The last column takes the remaining space.</dd>

<dt><kbd>Sorting</kbd></dt>
<dd>Specifies the index of the column used to sort the list. 0 for the first column, 1 for the second one, and so on.</dd>
</dl>


<h4>Shortcuts settings</h4>

<pre>
Shortcut=<i>keystroke</i>
Code=<i>keystroke code</i> (internally used by Clavier+)
DistinguishLeftRight=<i>0 or 1</i>
Description=<i>description text</i>
Text=<i>text to type when the shortcut is done</i>
&gt;<i>Other line to type</i>
&gt;<i>Another line</i>
...
Command=<i>program to launch when the shortcut is done</i>
Directory=<i>startup directory</i>
Window=<i>window mode of the program to launch</i>
SupportFileOpen=<i>0 or 1</i>
Programs=<i>programs list</i>
AllProgramsBut=<i>programs list</i>
CapsLock=<i>condition</i>
NumLock=<i>condition</i>
ScrollLock=<i>condition</i>
</pre>

<p>Note the necessity to type a <kbd>&gt;</kbd> character at the beginning of additional lines for the <kbd>Text=</kbd> field.</p>

<p><kbd>Text</kbd> on a side, and <kbd>Command</kbd>, <kbd>Directory</kbd> and <kbd>Window</kbd> on the other side are mutually exclusive: a shortcut can’t write a text and execute a command line at the same time.</p>

<dl>
<dt><kbd>Shortcut</kbd></dt>
<dd>Textual form of the keystroke, in the same format than in the configuration window.</dd>

<dt><kbd>Code</kbd></dt>
<dd>Numerical representation of the keystroke, generated and used by Clavier+. This code is used only if the <kbd>Shortcut</kbd> field is erroneous.</dd>

<dt><kbd>DistinguishLeftRight</kbd></dt>
<dd>Specifies whether Clavier+ should distinguish between left-side and right-side specials keys. If this setting is 1, <kbd>Ctrl</kbd>, <kbd>Alt</kbd>, <kbd>Shift</kbd> and <kbd>Win</kbd> keys located at the left side of the keyboard are distinguished from their equivalent located at the right side. This allows to create more shortcuts. If this settings is 0 (default value), the side of the special keys is not relevant in the keystroke.</dd>

<dt><kbd>Directory</kbd> (command mode only)</dt>
<dd>Startup directory of the command. If none is given, Clavier+ uses the directory of the executable itself.</dd>

<dt><kbd>Window</kbd> (command mode only)</dt>
<dd>Initial size of the main window of the launched program, among: <kbd>Normal</kbd>, <kbd>Minimized</kbd>, <kbd>Maximized</kbd>.</dd>

<dt><kbd>SupportFileOpen</kbd> (command mode only)</dt>
<dd>If the command is the path of a directory, specifies whether Clavier+ should detect File/Open dialog boxes to change their current directory (value 1). If the detection fails, or if this settings is 0 (default value), the directory is opened in Windows Explorer.</dd>

<dt><kbd>Programs</kbd>, <kbd>AllProgramsBut</kbd> (mutually exclusive)</dt>
<dd>Activation condition: list of the only programs for which the shortcut is activated (<kbd>Programs</kbd>) or disabled (<kbd>AllProgramsBut</kbd>). The programs are semi-colon-separated. They don’t have a full path: file name only, with extension.</dd>

<dt><kbd>CapsLock</kbd>, <kbd>NumLock</kbd>, <kbd>ScrollLock</kbd></dt>
<dd>If specified, specify an activation condition to the shortcut. Accepted values: <kbd>None</kbd> (default value), <kbd>Yes</kbd> and <kbd>No</kbd>.</dd>
</dl>


<h2 id="cmdline">Command line options</h2>

<p>Clavier+ accepts the following command line options:</p>

<dl>
<dt><kbd>/launch</kbd></dt>
<dd>Launch Clavier+, if necessary, and let it execute in background. The settings window is not displayed.</dd>

<dt><kbd>/settings</kbd></dt>
<dd>Launch Clavier+ in background, if necessary, and display the settings window.</dd>

<dt><kbd>/menu</kbd></dt>
<dd>Launch Clavier+ in background, if necessary, then display Clavier+ menu. The menu can be displayed manually by right clicking Clavier+ icon near the system clock.</dd>

<dt><kbd>/quit</kbd></dt>
<dd>Quit Clavier+, silently. If Clavier+ is not launched, do nothing.</dd>

<dt><kbd>/addtext</kbd></dt>
<dd>Display the window for adding a text shortcut. If necessary, launch Clavier+ in background and display the settings window.</dd>

<dt><kbd>/addcommand</kbd></dt>
<dd>Display the window for adding a program launching shortcut. If necessary, launch Clavier+ in background and display the settings window.</dd>

<dt><kbd>/load <i>configuration_file.ini</i></kbd></dt>
<dd>If Clavier+ is not already launched, launch it and load the given configuration file. If Clavier+ is already launched, do not launch it again but change the configuration file of the current instance of Clavier+. Enclose the filename in quotes if it contains spaces, for example: <kbd>clavier.exe /load "Internet shortcuts.ini"</kbd></dd>

<dt><kbd>/merge <i>configuration_file.ini</i></kbd></dt>
<dd>If Clavier+ is not already launched, launch it and merge the default configuration file (or the one specified by <kbd>/load</kbd>, if any), with the given configuration file. If Clavier+ is already launched, merge the configuration file of the current Clavier+ instance with the given configuration file. Merged shortcuts creating conflicts or ambiguities with the current shortcuts will not be added.</dd>

<dt><kbd>/sendkeys "<i>text</i>"</kbd></dt>
<dd>Simulate text typing. The text follows the <a href="#text">syntax specified above</a>. This option allows, for example, to type text when double-clicking on a Windows shortcut, or at Windows startup, or when choosing a command in Explorer context menu. Quotes and backslashes must be escaped by a backslash, for example: <kbd>clavier.exe /sendkeys "Write a \"quoted\" word and a single \\ backslash"</kbd></dd>
</dl>

<p>If Clavier+ is launched without any argument, the behavior depends of whether Clavier+ is already launched. If no, launch Clavier+ silently. If yes, do not launch Clavier+ again but display the configuration window. This allows to access Clavier+ options even if its icon is hidden.</p>


<h2 id="limits">Known issues</h2>

<h3>Unavailable shortcuts</h3>

<p>Some special keys can’t be used:</p>
<pre>
Print Screen
Pause
</pre>

<p>The special keys “Refresh browser”, “increase volume”, etc. are partially supported. Shortcuts using them can be created, and it is possible to modify their original behavior. However the action of these keys is executed when they are pressed in the <i>Add</i> dialog box. Moreover, as Windows does not provide a generic method to get the name of theses special keys, they are named by a number (for example: <kbd>#183</kbd>).</p>

<p>Windows standard shortcuts cannot be modified. Here are some of them:</p>

<table><colgroup><col width="30%"/><col/></colgroup>
<tr><td><kbd>Ctrl + Alt + DEL</kbd></td><td>show task manager</td></tr>
<tr><td><kbd>F12</kbd></td><td>reserved to the debugger</td></tr>
<tr><td><kbd>Alt + Tab</kbd></td><td>activate the next task</td></tr>
<tr><td><kbd>Alt + Shift + Tab</kbd></td><td>activate the previous task</td></tr>
<tr><td><kbd>Win + B</kbd></td><td>give the focus to the traybar</td></tr>
<tr><td><kbd>Win + D</kbd></td><td>minimize or restore all windows</td></tr>
<tr><td><kbd>Win + E</kbd></td><td>launch the explorer</td></tr>
<tr><td><kbd>Win + F</kbd></td><td>show the <i>Find files</i> window</td></tr>
<tr><td><kbd>Win + Ctrl + F</kbd></td><td>show the <i>Find computers</i></td></tr>
<tr><td><kbd>Win + L</kbd></td><td>fast user switching</td></tr>
<tr><td><kbd>Win + M</kbd></td><td>minimize all windows</td></tr>
<tr><td><kbd>Win + Shift + M</kbd></td><td>cancel the effect of Win + M</td></tr>
<tr><td><kbd>Win + R</kbd></td><td>show Start/Run window</td></tr>
<tr><td><kbd>Win + U</kbd></td><td>launch the utilities manager</td></tr>
<tr><td><kbd>Win + F1</kbd></td><td>launch Windows help</td></tr>
<tr><td><kbd>Win + Tab</kbd></td><td>activate the next taskbar button</td></tr>
<tr><td><kbd>Win + Shift + Tab</kbd></td><td>activate the previous taskbar button</td></tr>
<tr><td><kbd>Win + Pause</kbd></td><td>show the <i>System</i> applet of the configuration panel</td></tr>
</table>

<p>Windows 7 has a few more standard shortcuts that cannot be modified:</p>

<table><colgroup><col width="30%"/><col/></colgroup>
<tr><td><kbd>Win + =</kbd></td><td>magnifier</td></tr>
<tr><td><kbd>Win + B</kbd></td><td>give the focus to the notifications area</td></tr>
<tr><td><kbd>Win + G</kbd></td><td>show desktop gadgets</td></tr>
<tr><td><kbd>Win + Home</kbd></td><td>minimize or maximize all inactive windows</td></tr>
<tr><td><kbd>Win + P</kbd></td><td>show presentation mode projector options</td></tr>
<tr><td><kbd>Win + T</kbd></td><td>cycle through taskbar buttons</td></tr>
<tr><td><kbd>Win + Shift + T</kbd></td><td>cycle through taskbar buttons in reverse order</td></tr>
<tr><td><kbd>Win + X</kbd></td><td>launch mobility center</td></tr>
<tr><td><kbd>Win + Space</kbd></td><td>Aero desktop peek</td></tr>
<tr><td><kbd>Win + arrow</kbd></td><td>dock, maximize, or minimize window</td></tr>
<tr><td><kbd>Win + Shift + arrow</kbd></td><td>change monitor, or change vertical size of window</td></tr>
<tr><td><kbd>Win + digit</kbd></td><td>open taskbar pinned</td></tr>
</table>


<h3>Shortcuts having side effects</h3>

<p>By default under Windows, the <kbd>Alt + Shift</kbd> shortcut changes the keyboard layout. You are strongly encouraged not to use shortcuts like <kbd>Alt + Shift + <i>key</i></kbd>, because you could change the keyboard layout by mistake.</p>


<h3>Partially incompatible programs</h3>

<p>Clavier+ may encounter difficulty with some programs when typing text or simulating keystrokes:</p>
<ul>
<li>Some cross-platform programs, which do not respect Windows standard in matter of keyboard handling. It concerns <b>Java</b> programs like <b>OpenOffice</b>, Mozilla software (<b>Firefox</b>, <b>Thunderbird</b>), <b>Opera</b>, etc. If a problem occurs in one of those programs, use the <kbd>[|<i>text</i>|]</kbd> syntax to make Clavier+ using low-level techniques when typing text (better compatibility, but slower and more limited).</li>
<li><b>Games</b>, because they bypass Windows, thus Clavier+, when handling the keyboard.</li>
<li>System programs, because they bypass Windows too. For example: <kbd>command.com</kbd>, emulators and virtual machines (Cygwin, VirtualPC), virtualizers (VNC).</li>
</ul>


<h3>Other limitations</h3>

<p>Some shortcuts do not allow fast repetition: you may have to release all special keys (Ctrl, Alt, etc.), then press them again to repeat the shortcut. Shortcuts that simulate other shortcuts or launch programs, Clavier+ has to release the special keys. This avoids the shortcuts to mix and the launched programs to detect that some special keys are down. For example, if <kbd>Ctrl+X</kbd> is associated to <kbd>[Alt+Y]</kbd>, Clavier+ releases the <kbd>Ctrl</kbd> key, otherwise <kbd>Ctrl+Alt+Y</kbd> would be simulated instead of <kbd>Alt+Y</kbd>. For technical reasons, Clavier+ cannot determine whether the user has released or not the special keys before the end of the shortcut, indicating whether or not they should be pressed again to allow shortcut repetition. To avoid buggy keyboard behavior, Clavier+ never presses the special keys down again.</p>


<h2 id="faq">FAQ</h2>

<p>You can access the last version of this FAQ in <a href="http://utilfr42.free.fr/util/Clavier.php#faq">Clavier+ page</a>.</p>

<div id="windows" class="faq-question">1. Which Windows versions is Clavier+ compatible with?</div>
<div class="faq-answer"><p>The latest Clavier+ version is compatible with all NT family Windows versions: 2000, NT, XP, Vista, 7, 8. The <a href="#old">older Clavier+ versions</a> are compatible with Windows 95/98/ME too.</p></div>
<div id="incompatprog" class="faq-question">2. Clavier+ can’t write text in <i>MyFavoriteProgram</i>!</div>
<div class="faq-answer"><p>Some programs handle the keyboard in a non-standard way, preventing Clavier+ from writing text. To get around this problem, surround your text with <kbd>[|</kbd> and <kbd>|]</kbd>, as below:</p><p><kbd>[|My text|]</kbd></p></div>
<div id="games" class="faq-question">3. Does Clavier+ work with games?</div>
<div class="faq-answer"><p>Most of the time, no. Games access the keyboard in low-level, for various raisons: speed, cheat protection.</p></div>
<div id="textformat" class="faq-question">4. How to write formatted text, e.g. bold, hyperlinks?</div>
<div class="faq-answer"><p>There is no standard way to format text: the exact procedure depends on which program you want to write text in (Word, Excel, OpenOffice).</p><p>The AutoText feature of Word allows to insert any formatted text block. With other programs, you can use keyboard shortcuts. For example, <kbd>Ctrl+B</kbd> often toggles the bold attribute. To make a word bold, one can write:</p><p><kbd>A [Ctrl+B]bold[Ctrl+B] word</kbd></p><p>Again, formatting hotkeys depend on the program you are using. Please refer to its documentation for more details.</p></div>
<div id="maclinux" class="faq-question">5. Is Clavier+ available on Mac, Linux, or any other non-Windows OS?</div>
<div class="faq-answer"><p>No, Clavier+ is for Windows only. In particular, there is no Mac or Linux version, and I don’t know if software equivalent to Clavier+ exists for these systems.</p></div>
<div id="password" class="faq-question">6. How to protect Clavier+ with a password?</div>
<div class="faq-answer"><p>Acess to Clavier+ shortcut list cannot be password protected. Indeed, storing data in a secure fashion is both difficult and restrictive in terms of available features. I strongly recommend using software specialized in passwords storage, such as <a href="http://keepass.sourceforge.net/">KeePass</a>, <a href="http://passwordsafe.sourceforge.net/">Password Safe</a> or <a href="http://www.roboform.com/fr/">RoboForm</a>.</p></div>
<div id="numpadcomma" class="faq-question">7. How to make the numpad dot key write a comma?</div>
<div class="faq-answer"><p>Click the plus shaped button, choose <i>Write Text</i>, press the numpad dot key, then click the <i>OK</i> button. Write a comma in the <i>Write text</i> area.</p></div>
<div id="specialfolder" class="faq-question">8. How to create a shortcut to a special folder: My computer, Control panel, …?</div>
<div class="faq-answer"><p>In Windows Explorer, create a Windows shortcut to the special folder: press the right mouse button on the special folder, drag the mouse to another folder (for example <kbd>C:\</kbd>), release the buton and choose <i>Create shortcut here</i> in the popup menu.</p><p>Then, in Clavier+, create a <i>Launch a program</i> keyboard shortcut that executes the Windows shortcut you have just created. You have to write the full path manually, and to append the <kbd>.lnk</kbd> extension. For example: <kbd>C:\My computer.lnk</kbd> if you have created a shortcut named <kbd>My computer</kbd> in the folder <kbd>C:\</kbd>.</p><p>Some special folders can be opened without the need for a shortcut. For instance, <kbd>::{20d04fe0-3aea-1069-a2d8-08002b30309d}</kbd> opens My computer. The CLSIDs marked as <i>supported by Run</i> in <a href="http://www.autohotkey.com/docs/misc/CLSID-List.htm">this list</a> are also available.</p></div>
<div id="explorertreepane" class="faq-question">9. How to open a folder in Explorer and display the tree pane?</div>
<div class="faq-answer"><p>In the shortcut command line, insert <kbd>explorer /e,</kbd> before the folder path; make sure to write a comma after <kbd>/e</kbd>. For example: <kbd>explorer /e, C:\</kbd></p></div>
<div id="hideicon" class="faq-question">10. How to remove Clavier+ icon from the traybar?</div>
<div class="faq-answer"><p>Launch Clavier+ then quit it. Double-click on the <kbd>Clavier.ini</kbd> file located in the same directory than Clavier+. In the second line, that begins with <kbd>Size=</kbd>, replace the <i>last</i> zero by the digit one. For example: <kbd>Size=923,501,0,0</kbd> should become <kbd>Size=923,501,0,1</kbd>.</p><p>As Clavier+ icon will no more be visible, you will have to launch Clavier+ twice to display its configuration window (once to launch it, once to display the window).</p></div>
<div id="linereturn" class="faq-question">11. How to write a line return with a shortcut?</div>
<div class="faq-answer"><p>Two solutions:</p><ul><li>insert a line return in the edit box, by pressing the <kbd>Return</kbd> key,</li><li>if the previous solution doesn’t work, write the code <kbd>[ENTER]</kbd><br/>The shortcut will probably have to pause for a short time to let the return key be processed: <kbd>[][ENTER]</kbd></li></ul></div>
<div id="simulkey" class="faq-question">12. How to simulate the key <i>XYZ</i></div>
<div class="faq-answer"><p>Click the arrow-shape button, choose the command <i>Simulate a Keystroke</i>.</p></div>
<div id="soundvolume" class="faq-question">13. How to change the sound volume?</div>
<div class="faq-answer"><p>There are three keys related to sound volume:</p><ul><li>mute: code <kbd>[#173]</kbd></li><li>higher volume: code <kbd>[#175]</kbd></li><li>lower volume: code <kbd>[#174]</kbd></li></ul><p>To simulate those keys and change the volume with your keyboard, create a shortcut with Clavier+ in text mode, then write the key code in the <i>Write text</i> area, between brackets.</p><p>You can use the program <a href="http://utilfr42.free.fr/dn/VolumeManager.exe">VolumeManager</a> to adjust the volume finely.</p></div>
<div id="musicplayer" class="faq-question">14. How to control a music player: next track, pause, etc.?</div>
<div class="faq-answer"><p>There are four keys related to music players:</p><ul><li>next track: code <kbd>[#176]</kbd></li><li>previous track: code <kbd>[#177]</kbd></li><li>stop: code <kbd>[#178]</kbd></li><li>play/pause: code <kbd>[#179]</kbd></li></ul><p>These keys work even if the music player in not the active application. To use them, create a shortcut with Clavier+ in text mode, then write the key code in the <i>Write text</i> area, between brackets.</p></div>
<div id="browseractions" class="faq-question">15. How to control the Internet browser: previous page, favorites, etc.?</div>
<div class="faq-answer"><p>There are several keys related to Internet browsers:</p><ul><li>back: code <kbd>[#166]</kbd></li><li>forward: code <kbd>[#167]</kbd></li><li>refresh: code <kbd>[#168]</kbd></li><li>stop: code <kbd>[#169]</kbd></li><li>search: code <kbd>[#170]</kbd></li><li>favorites: code <kbd>[#171]</kbd></li><li>home: code <kbd>[#172]</kbd></li><li>e-mail: code <kbd>[#180]</kbd></li><li>media player: code <kbd>[#181]</kbd></li><li>application 1: code <kbd>[#182]</kbd></li><li>application 2: code <kbd>[#183]</kbd></li></ul><p>These keys work only if the Internet browser is active.</p></div>
<div id="autostartup" class="faq-question">16. The checkbox <i>Launch Clavier+ at Windows startup</i> doesn’t work!</div>
<div class="faq-answer"><p>Create a shortcut to <kbd>Clavier.exe</kbd> in <i>Start Menu/Programs/Startup</i>. To do this, click with the right button on <kbd>Clavier.exe</kbd>, keep the button down and drag the mouse to the Start menu, then <i>Programs</i>, then <i>Startup</i>, and release the mouse button. Choose <i>Create a shortcut here</i>.</p></div>
<div id="twoprograms" class="faq-question">17. How to launch two programs at once?</div>
<div class="faq-answer"><p>The solution is to enclose the path of the two programs in double brackets, in the <kbd>Write text</kbd> area. For example, to launch notepad and the calculator:</p><pre>[[notepad.exe]][[calc.exe]]</pre></div>
<div id="mouse" class="faq-question">18. How to simulate a mouse click, a double-click, a right click?</div>
<div class="faq-answer"><p>You need to create a shortcut of type <i>Write text</i> and use the <kbd>[{MouseButton,<i>code</i>}]</kbd> special command. For example, to simulate a left click: <kbd>[{MouseButton,L}]</kbd>. For a double-click, execute two left clicks: <kbd>[{MouseButton,L}][{MouseButton,L}]</kbd>. For a right click, use the <kbd>R</kbd> code: <kbd>[{MouseButton,R}]</kbd>.</p></div>
<div id="complicatedactions" class="faq-question">19. How to do more complicated things, like writing the current date</div>
<div class="faq-answer"><p>You can create a VBScript program and ask Clavier+ to execute it. The generic procedure is the following: launch Notepad, write the text of your script, save it with the <kbd>.VBS</kbd> file extension, then associate a shortcut to it with Clavier+.</p><p>An example: write the current date in the active program.</p><pre>set shell = WScript.CreateObject("WScript.Shell")<br/>shell.SendKeys Date()</pre><p>If you want to write the date in another format, you can use the <a href="http://www.google.com/search?hl=en&amp;q=vbscript+date+functions+-ASP">VBScript date functions</a>.</p></div>
<div id="transferparams" class="faq-question">20. How to transfer Clavier+ settings to a new computer?</div>
<div class="faq-answer"><p>To keep your Clavier+ shortcuts after upgrading or reformatting your computer, you can transfer the <kbd>Clavier.ini</kbd> configuration file, located in Clavier+ directory. Detailed procedure:</p><ol><li>On the new computer: install Clavier+.</li><li>On the new computer: click on <i>Quit</i> in Clavier+ configuration window, then confirm.</li><li>Copy the <kbd>Clavier.ini</kbd> file located in Clavier+ directory from the old to the new computer.</li><li>On the new computer: restart Clavier+.</li></ol></div>



<h2 id="examples">Shortcuts examples</h2>

<ul>
<li>Create a new folder in Windows Explorer<br/>text <kbd>[#93][N][ENTER]</kbd> with the program condition <kbd>explorer.exe</kbd></li>
<li>Execute the <i>File</i>/<i>Quit</i> menu command<br/>text <kbd>[Alt+F4]</kbd> or text <kbd>[Alt+F][Q]</kbd></li>
<li>Translate to French the selected word with an online dictionary<br/>text <kbd>[Ctrl+C][[http://www.wordreference.com/enfr/%CLIPBOARD%]]</kbd></li>
<li>Write an e-mail<br/>command <kbd>mailto:</kbd> or <kbd>mailto:somebody@domain.com&amp;subject=Subject</kbd></li>
<li>Scroll the active program 3 lines downward<br/>text <kbd>[{MouseWheel,3}]</kbd></li>
<li>Display the control panel<br/>command <kbd>control.exe</kbd></li>
<li>Higher or lower the volume<br/>text <kbd>[#175]</kbd> or text <kbd>[#174]</kbd></li>
<li>Paste the selection to Notepad<br/>text <kbd>[Ctrl+C][[notepad.exe]][][Ctrl+V]</kbd></li>
<li>Paste the clipboard as raw text, without formatting – warning: changes the contents of the clipboard<br/>text <kbd>[[notepad.exe]][][Ctrl+V][Ctrl+A][Ctrl+X][Alt+F4][N][][Ctrl+V]</kbd></li>
<li>Fill a form<br/>text <kbd>first field[TAB][{Focus}]second field[TAB][{Focus}]third field[ENTER]</kbd></li>
<li>Shutdown Windows<br/>command <kbd>shutdown.exe -s -t 01</kbd></li>
<li>Restart Windows<br/>command <kbd>shutdown.exe -r -t 01</kbd></li>
<li>Logoff from Windows<br/>command <kbd>shutdown.exe -l</kbd></li>
</ul>

</body>
</html>
