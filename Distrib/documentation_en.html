<h1>Clavier+ documentation</h1>

<p class="doc-toc">
<a href="#name">Why such a strange name?</a>
<a href="#author">Author</a>
<a href="#license">License</a>
<a href="#setup">Setup</a>
<a href="#utility">What can Clavier+ do</a>
<a href="#add">Create a keyboard shortcut</a>
<a href="#conditions">Conditions applied to the shortcuts</a>
<a href="#text">Actions of a text shortcut</a>
<a href="#print">Printing the shortcuts list</a>
<a href="#conffile">Configuration files</a>
<a href="#cmdline">Command line options</a>
<a href="#limits">Known issues</a>
<a href="#faq">Frequently Asked Questions (FAQ)</a>
<a href="#examples">Shortcuts examples</a>


<h2 style="clear: both"><a href="{{MAIN_URL}}">Clavier+ website</a></h2>


<h2 id="name">Why such a strange name?</h2>

<p><i>Clavier</i> simply is the French word for <i>keyboard</i>. Note the incredible originality of this name, and the amount of creativity deployed to find it!


<h2 id="author">Author</h2>

<p><a href="https://gryder.org">Guillaume Ryder</a>

<p>Save time by <b>checking out the <a href="#faq">FAQ</a></b> before sending me an email: it answers most of the questions I receive.


<h2 id="license">License</h2>

<p>Clavier+ is released under the <a href="https://www.gnu.org/licenses/gpl-3.0.html">GPLv3 license</a>. This gives you the right to use, copy, distribute the software, for any use (personal or commercial), all that without having to pay anything.

<p>There is no warranty for this program, I’m not responsible of any damage due to its use.

<p>The full source code of Clavier+ is available here:<br>
<a href="https://github.com/guilryder/clavier-plus"><kbd>https://github.com/guilryder/clavier-plus</kbd></a>


<h2 id="setup">Setup</h2>

<p>Clavier+ is available in multiple versions:
<ul>
<li><b>With</b> setup program: <a href="ClavierSetup.exe"><kbd>ClavierSetup.exe</kbd></a>
<li><b>Without</b> setup program: <a href="Clavier.zip"><kbd>Clavier.zip</kbd></a>
</ul>

<p>To install Clavier+ manually, without the setup program:
<ol>
<li>Download the <a href="Clavier.zip">Zip archive</a> and unzip it.
<li>Launch <kbd>Clavier.exe</kbd>.
<li>If you want the shortcuts to be always active, launch <kbd>Clavier.exe</kbd> again to display the configuration dialog box, then check the <i>Launch Clavier+ at Windows startup</i> checkbox.
</ol>

<p>To uninstall Clavier+ after a manual installation:
<ol>
<li>In Clavier+ configuration, uncheck the <i>Launch Clavier+ at Windows startup</i> checkbox, if necessary.
<li>Quit Clavier+ by clicking the button having this name.
<li>Delete all Clavier+ files.
</ol>


<h2 id="utility">What Clavier+ can do</h2>

<p>Clavier allows associating an action to any keyboard shortcut. Those actions can be:
<ul>
<li>launch a program or an app: Microsoft Word, calculator, Internet browser, etc.
<li>display a website
<li>open a folder: <i>My documents</i>, <kbd>C:</kbd>, external hard drive, etc.
<li>write special characters: ® and © symbols, currency symbols like € or ¥, etc.
<li>write text: E-mail address, company name, etc. in any program (Microsoft Word, Internet browser, Notepad)
<li>simulate keystrokes, for example to execute a command in the menus of a program
<li>simulate mouse moves, clicks, and mouse wheel scrolls
</ul>

<p>The keyboard shortcuts can use (<a href="#limits-unavailable-shortcuts">almost</a>) any key of the keyboard. The Windows key, located around the spacebar, can be used along with Ctrl, Alt and Shift. As programs rarely use this key, many simple keyboard shortcuts are available to you: <kbd>Win + Ctrl + A</kbd>, <kbd>Win + .</kbd>, etc.

<p>Clavier+ can modify the behavior of special keys like <kbd>`</kbd> or <kbd>F11</kbd>. Thus a keyboard shortcut of one single key can be associated to a frequently used action.

<p>If necessary, the action of a keyboard shortcut can depend of the active program. This allows adding shortcuts to a specific program.

<p>Likewise, the action of a keyboard shortcut can depend of the state of the toggle keys, i.e. the keys having small lights in the keyboard: Caps Lock, Num Lock, Scroll Lock. For example, this allows writing special characters instead of digits when the caps lock mode is set.

<p><a href="#examples">Shortcuts examples</a>


<h2 id="add">Create a keyboard shortcut</h2>

<p>Launch Clavier+. A small keyboard icon appears in the <a href="https://support.microsoft.com/en-us/windows/e159e8d2-9ac5-b2bd-61c5-bb63c1d437c3">taskbar notification area</a> next to the system clock. It indicates that Clavier+ is running and keyboard shortcuts are active. Click the icon to display the configuration window. You can resize the window if you find it too small. The upper area contains a few example shortcuts.

<p>To create a new keyboard shortcut, click the <i>Add</i> button (shaped like a + symbol), and choose a keyboard shortcut action:
<ul>
<li><b>Program:</b> execute a program of the Start menu
<li><b>App:</b> start a Microsoft Store application
<li><b>Special Character:</b> write a special character
<li><b>Folder:</b> open a folder with Windows Explorer
<li><b>Write Text:</b> simulate typing some text, and/or sending keystrokes (for example the <kbd>Tab</kbd> key to navigate across form fields)
<li><b>Launch a Program:</b> launch a program missing in the Start menu, or execute a command line
<li><b>Display a Website:</b> open a website with your Internet browser
</ul>

<p>You can also drag and drop a file or a program into the Clavier+ configuration window to create a shortcut for it.

<p>A dialog box appears for you to specify the keyboard shortcut. Type it in the dedicated area: its text name should be written in the textbox. Then, click the <i>OK</i> button.

<p>If necessary, modify the shortcut action in the lower part of the configuration window. If the shortcut should write text, for example an E-mail address, check that the <i>Write text</i> option is checked, and then enter your text in the large text area. Each time you type the keyboard shortcut, Clavier+ will write the specified text. You can use the <a href="clavier_arrow_menu_EN.png">arrow menu</a> to <a href="#text">perform special actions</a> beyond typing text: simulate a keystroke, launch a program, etc.

<p>If the shortcut should launch a program or display a website, check the corresponding option. Write the path of your program or the URL of your website in the area below. You can use the small button on the right to look for the program to launch. You can check what your shortcut does by clicking the <i>Test</i> button. If necessary, click the <i>Advanced settings</i> button to specify the initial directory or the initial window size of the program (maximized, windowed, minimized).

<p><span class="ipt">Important:</span> you need to close the Clavier+ configuration window <i>before</i> testing your shortcuts. The shortcuts remain disabled while the window is visible.


<h2 id="conditions">Conditions applied to the shortcuts</h2>

<p>You can set conditions to the triggering of a shortcut. If all conditions at met, Clavier+ executes the action of the shortcut. If one or more conditions are not met, Clavier+ lets Windows or the active program execute the original action of the shortcut, if any. This allows associating multiple actions to the same shortcut.

<p><span class="ipt">Warning!</span> If you associate multiple actions to the same shortcut, make sure to avoid ambiguities by giving the shortcuts mutually exclusive conditions. Otherwise, an error message will appear when you close the window. For example, if you want to associate <kbd>Ctrl + X</kbd> to Notepad when <kbd>Num Lock</kbd> is off and to the Calculator otherwise, you <i>must</i> give the condition “Num Lock: must be on” to the second shortcut. This is because “Num Lock: no condition” can be ambiguous with other shortcuts, such as <kbd>Ctrl + X</kbd> with the condition “Caps Lock: must be on”.

<p><span class="ipt">Important:</span> shortcuts with conditions have <a href="#limits-conditions">some known issues</a>.


<h3 id="conditions-active">Active program</h3>

<p>You can restrict a shortcut to some programs. This allows giving different meanings to the same shortcut, depending of the active program. By default, shortcuts are enabled for “all programs but: <i>none</i>”, i.e. for all programs.

<p>You can define two kinds of condition on the active program. The shortcut can be enabled for all programs except specific ones (exclusive criteria), or only for specific programs (inclusive criteria). Choose the condition type in the <i>Activate for</i> drop-down, after selecting your shortcut in the list.

<p>To define the list of programs of the condition, click the small sight on the right (white background). Then keep the left mouse button down, and move the sight to the window of the program you want to select (for example, the window of Notepad or Windows Explorer). The name of the program is written in the text box at the left of the sight. Repeat this operation for each program to add to the list.

<p>For a given keystroke, you can define any number of shortcuts with an <i>only these programs</i> condition as long as they refer to different programs. For a given keystroke, you can define at most one shortcut with an <i>all programs but</i> condition.

<p>Shortcuts of type <i>only these programs</i> have precedence over <i>all programs but</i> shortcuts. If you create two shortcuts for the same keystroke, associate the condition “only these programs: <kbd>notepad.exe</kbd>” to the first one, “all programs but: <i>none</i>” to the second one, and if you execute the keystroke in Notepad, Clavier+ executes the first shortcut and ignores the second one.


<h3 id="conditions-toggle-keys">Toggle keys</h3>

<p>You can configure a shortcut to trigger only for certain states of the toggle keys: <kbd>Caps Lock</kbd>, <kbd>Num Lock</kbd>, <kbd>Scroll Lock</kbd>. For example, you can create a keyboard shortcut active only in caps lock mode.

<p>To set toggle keys conditions for a shortcut, double-click the shortcut in the list. In the <i>Activation condition</i> area, set a condition for each toggle key. You can require the key to be enabled, disabled, or set no condition on it.


<h2 id="text">Actions of a text shortcut</h2>

<p>In the <i>Write text</i> textbox, you can use a combination of multiple types of actions:


<h3 id="text-typing">Typing text</h3>

<p>Write the text to type in the text area. Use <i>Write a character</i> in the <a href="clavier_arrow_menu_EN.png">arrow menu</a> to insert special characters unreachable from the keyboard.

<p>Typing text does not work with some programs. You can try to use the <kbd>[|<i>text to write</i>|]</kbd> syntax to make Clavier+ use low-level techniques when typing text (better compatibility, but slower and more limited).


<h3 id="text-simulating-keystroke">Simulating a keystroke</h3>

<p>Use the <i>Simulate a Keystroke</i> in the <a href="clavier_arrow_menu_EN.png">arrow menu</a> to write the keystroke code. Typically, the code is the name of the keystroke between brackets, for example: <kbd>[Ctrl+O]</kbd>.

<p>Note that simulating a keystroke allows performing many different actions such as manipulating the clipboard (with <kbd>Ctrl + C</kbd> and <kbd>Ctrl + V</kbd>) or executing menu commands (with <kbd>Alt + <i>letter</i></kbd>).


<h3 id="text-launching-program">Launching a program</h3>

<p>Use the <i>Launch a Program</i> command in the <a href="clavier_arrow_menu_EN.png">arrow menu</a>, or write the command line to execute enclosed in double brackets. For example, to open a text file and move the cursor to its end:<br>
<kbd>[[notepad.exe C:\\TODO.txt]][][Ctrl+End]</kbd>

<p>This syntax allows launching several programs with the same shortcut. For example, to launch Notepad and the calculator:<br>
<kbd>[[notepad.exe]][[calc.exe]]</kbd>

<p>The command line can contain <kbd>%</kbd>-enclosed environment variables, like in <kbd>explorer.exe %WINDIR%</kbd> to open the Windows directory with the Explorer.

<p>Clavier+ sets the <kbd>%CLIPBOARD%</kbd> environment variable to the text currently stored in the clipboard. For example, to open the selected URL with Internet Explorer:<br>
<kbd>[Ctrl+C][][[iexplore.exe %CLIPBOARD%]]</kbd>


<h3 id="text-syncing">Synchronizing</h3>

<p>If your shortcut executes several actions sequentially, you may need Clavier+ to wait a little time between them to let them fully execute. To insert a pause, write a pair of brackets: <kbd>[]</kbd>. Clavier+ will wait for 100 milliseconds, then detect the new focused window. You can also use the command <a href="#Focus"><kbd>[{Focus}]</kbd></a> to specify the delay.

<p>This last point is crucial. If you simulate a keystroke that displays a new window (for example <kbd>Ctrl + O</kbd> which pops out the <i>File/Open</i> dialog box), then write some text (for example a filename), you must indicate to Clavier+ that the text should be typed in the <em>new</em> window:<br>
<kbd>[Ctrl+O][]MyFile.txt[ENTER]</kbd>

<p>Do the same if you launch a program that displays a window: ask Clavier+ to detect the new active window.<br>
<kbd>[Ctrl+C][[notepad.exe]][][Ctrl+V]</kbd><br>
This shortcut copies to the clipboard the text currently selected, launches Notepad, then pastes the copied text in it. The <kbd>[]</kbd> tag is crucial; it tells Clavier+ to paste to the <em>new</em> active window, i.e. Notepad.


<h3 id="text-special-commands">Executing special commands</h3>

<p>The <a href="clavier_arrow_menu_EN.png">arrow menu</a> lists the supported commands:

<dl>
<dt><kbd id="Wait">[{Wait,<i>duration</i>}]</kbd>
<dd>Pauses for the specified duration, in milliseconds.

<dt><kbd id="Focus">[{Focus,<i>delay</i>,<i>window name</i>}]</kbd>
<dd><div>Detects or sets the new active window. The <i>window name</i> and <i>delay</i> parameters are optional.</div>
<p>If not empty, <i>delay</i> is the number of milliseconds to wait before activating the window. It may be useful give enough time for the window to appear before trying to activate it. If <i>delay</i> is not specified, there is no delay.
<p>If <i>window name</i> is empty, Clavier+ detects the new active window and will send the future keystrokes to it. Useful if a keystroke displays a new window in which the shortcut needs to write. Example:<br>
<kbd>[{Focus}]</kbd> or <kbd>[{Focus,200}]</kbd>
<p>If <i>window name</i> is not empty, Clavier+ activates the first window matching the given name. The name can contain <kbd>*</kbd> and <kbd>?</kbd> wildcards. Escape commas with a backslash as if it were a <a href="#text-special-chars">special character</a>. Example:<br>
<kbd>[{Focus,50,* - Microsoft Word}]</kbd> or <kbd>[{Focus,,Title\, subtitle}]</kbd>
<p>By default, the shortcut execution stops if the window is not found. To continue executing the shortcut even if the window is not found, insert an exclamation mark <kbd>!</kbd> before the window title. If you want to search for a window with a title that starts with <kbd>!</kbd>, escape the exclamation mark with a backslash as if it were a <a href="#text-special-chars">special character</a>. Examples:<br>
<kbd>[{Focus,0,*Internet Explorer}][Alt+F4]</kbd> closes the first Internet Explorer window found. Does nothing if Internet Explorer is not running.<br>
<kbd>[{Focus,0,!Untitled*}]Test</kbd> writes <kbd>Test</kbd> in the first window whose title starts with <kbd>Untitled</kbd>, or in the current window if no such window exists.<br>
<kbd>[{Focus,0,\!Warning!}]</kbd> activates the first window titled <kbd>!Warning!</kbd>.
<p>Note that <kbd>[{Focus,100}]</kbd> is equivalent to <kbd>[]</kbd>.

<dt><kbd id="FocusOrLaunch">[{FocusOrLaunch,<i>window name</i>,<i>command</i>,<i>delay</i>}]</kbd>
<dd><div>Activates a window like <a href="#Focus"><kbd>[{Focus,,<i>window name</i>}]</kbd></a>, or launches a program like <a href="#text-launching-program"><kbd>[[<i>command</i>]][{Wait,<i>delay</i>}]</kbd></a> if the window is not found.</div>
<p>If not empty, <i>delay</i> is the number of milliseconds to wait after launching the program. If Clavier+ finds a matching window or <i>delay</i> is not specified, there is no delay.
<p>Clavier+ activates the first window that matches <i>window name</i>; see <a href="#Focus"><kbd>[{Focus}]</kbd></a> for the syntax (exception: <kbd>!</kbd> has no special meaning and does not need escaping).
<p>If Clavier+ does not find any matching window, it executes the specified command, then waits for the specified delay (if any).
<p>Examples:<br>
<kbd>[{FocusOrLaunch,* - Notepad,notepad.exe}]</kbd> activates a Notepad window if one exists, else launches Notepad.<br>
<kbd>[{FocusOrLaunch,* - Notepad,notepad.exe,100}]Hello</kbd> activates a Notepad window if one exists, else launches Notepad and waits 100 milliseconds for the blank Notepad window to appear. Either way, after that, writes <kbd>Hello</kbd> in Notepad.<br>
<kbd>[{FocusOrLaunch,one\,two,C:\\program.exe one\,two}]</kbd> activates the window titled <kbd>one,two</kbd> if it exists, else executes <kbd>C:\progam.exe one,two</kbd>.

<dt><kbd id="Copy">[{Copy,<i>text</i>}]</kbd>
<dd>Copies the specified text to the clipboard. Beware that this command is completely unrelated to the <kbd>Ctrl + C</kbd> clipboard shortcut, which copies the <i>selection</i> to the clipboard. Associated to the <kbd>Ctrl + V</kbd> keystroke, this command allows writing a long text quickly, or to write many times the same text. The following example writes five time the same text:<br>
<kbd>[{Copy,A sentence to repeat five times. }][Ctrl+V][Ctrl+V][Ctrl+V][Ctrl+V][Ctrl+V]</kbd>

<dt><kbd id="MouseButton">[{MouseButton,<i>code</i>}]</kbd>
<dd>Simulates a mouse button action. <i>code</i> specifies the button to modify and its new state. It is made of one or two letters.  The first one, mandatory, specifies the button to modify: <kbd>L</kbd> = left button, <kbd>M</kbd> = middle button, <kbd>R</kbd> = right button. The second letter, optional, specifies the action to perform: <kbd>D</kbd> = press the button down, <kbd>U</kbd> = release the button up. If the second letter is not specified, the button is pressed then released: this simulates a click.
<p>Examples:<br>
<kbd>[{MouseButton,L}][{MouseButton,L}]</kbd> simulates a double-click with the left mouse button<br>
<kbd>[{MouseButton,RD}][{Wait,1000}][{MouseButton,RU}]</kbd> keeps the right mouse button down for 1 second

<dt><kbd id="MouseMoveTo">[{MouseMoveTo,<i>x</i>,<i>y</i>}]</kbd>
<dd>Moves the mouse cursor to the given (x,y) position, specified in pixels relatively to the upper-left corner of the screen. For example, if you have a screen size of 1,024 &times; 768 pixels, the following command will move the cursor to the upper right corner:<br>
<kbd>[{MouseMoveTo,1023,0}]</kbd>

<dt><kbd id="MouseMoveToFocus">[{MouseMoveToFocus,<i>x</i>,<i>y</i>}]</kbd>
<dd>Moves the mouse cursor to the given (x,y) position, specified in pixels relatively to the upper-left corner of the active window. For example, to move the mouse over the system menu if the active window:<br>
<kbd>[{MouseMoveToFocus,8,8}]</kbd>

<dt><kbd id="MouseMoveBy">[{MouseMoveBy,<i>dx</i>,<i>dy</i>}]</kbd>
<dd>Moves the mouse cursor by the given amount of pixels. For example, to move the mouse by 10 pixels left and 3 pixels down:<br>
<kbd>[{MouseMoveBy,-10,3}]</kbd>

<dt><kbd id="MouseWheel">[{MouseWheel,<i>ticks</i>}]</kbd>
<dd>Simulates a mouse wheel scroll. <i>ticks</i> specifies the number of ticks to scroll by. A positive value will scroll downwards, a negative one will scroll upwards. For example, to scroll twice upwards:<br>
<kbd>[{MouseWheel,-2}]</kbd>

<dt><kbd id="KeysDown">[{KeysDown,<i>keys</i>}]</kbd>
<dd>Presses and keeps down some special keys. <i>keys</i> lists the special keys to press; Clavier+ ignores non-special keys. For example, to press <kbd>Ctrl + Alt</kbd>:<br>
<kbd>[{KeysDown,Ctrl + Alt}]</kbd><br>
Clavier+ keeps the keys down until the next <kbd>[{KeysDown}]</kbd> or the end of the shortcut, affecting all commands in between except regular text. For example, the following shortcut simulates <kbd>Ctrl + Shift + A</kbd>, <kbd>Ctrl + left click</kbd>, then writes <kbd>HELLO world</kbd>:<br>
<kbd>[{KeysDown,Ctrl}][Shift + A][{MouseButton,L}][{KeysDown,Shift}][|Hello|][] world</kbd><br>
<kbd>[{KeysDown}]</kbd> without keys releases all special keys.
</dl>


<h3 id="text-special-chars">Special characters</h3>

<p>If you need to write special characters <kbd>\</kbd>, <kbd>[</kbd>, <kbd>]</kbd>, <kbd>{</kbd>, <kbd>}</kbd> or <kbd>|</kbd>, you need to escape them with a backslash. For example:<br>
<kbd>This is a bracket: \[, this is a single backslash: \\</kbd><br>
The <a href="clavier_arrow_menu_EN.png">arrow menu</a> has an entry listing all special characters.

<p>You need to write a backslash before special characters everywhere in the shortcut text, even in special tags such as keystroke simulation or program launching tags:<br>
<kbd>[[notepad.exe document\[1\].txt]]</kbd> to open the file named <kbd>document[1].txt</kbd> with Notepad


<h2 id="print">Printing the shortcuts list</h2>

<p>In the main window of Clavier+, click on <i>Copy list</i> button. This stores the list of all keyboard shortcuts in the clipboard: you can paste it in the word processor of your choice to print it. If you use Microsoft Word, you can present it as an array: launch Word, copy the list with <kbd>Ctrl + V</kbd>, select it with <kbd>Ctrl + A</kbd>, and click the <i>Insert array</i> button.


<h2 id="conffile">Configuration files</h2>

<p>By default, Clavier+ uses a single configuration file to store its settings: <kbd>Clavier.ini</kbd>, located in the same directory than Clavier+ main executable. Clavier+ doesn’t put anything in the registry except the <i>Launch Clavier+ at Windows startup</i> option.


<h3 id="conffile-multiple">Multiple configuration files</h3>

<p>You can create multiple configuration files to easily switch between multiple sets of shortcuts. You can switch between configuration files without restarting Clavier+.

<p>The Clavier+ menu, displayed by right clicking the Clavier+ icon in the <a href="https://support.microsoft.com/en-us/windows/e159e8d2-9ac5-b2bd-61c5-bb63c1d437c3">taskbar notification area</a>, provides several configuration file management commands:
<ul>
<li>Available configuration files: <kbd>*.ini</kbd> files located in Clavier+ directory; each entry loads the corresponding file.
<li>Load Configuration: loads a configuration file, if it is not in the list. Make sure not to load the configuration file of another program, it would be overwritten and lost.
<li>Merge Configuration With: merges a configuration file into the current one. Shortcuts creating conflicts or ambiguities with the current shortcuts will not be added. All your existing shortcuts are left unchanged (not overwritten).
<li>Save Configuration: saves the current shortcuts to a new configuration file.
</ul>

<p>Another way to load a configuration file is to run Clavier+ with the <kbd>/load</kbd> or <kbd>/merge</kbd> <a href="#cmdline">command line</a> option. This allows loading a configuration file with a keystroke, by associating a keyboard shortcut to the command line:
<pre>clavier.exe /load <i>configuration_file.ini</i></pre>


<h3 id="conffile-syntax">Configuration files syntax</h3>

<p>If you need to add many shortcuts at once, here is the configuration file format:

<pre>
Global settings
First shortcut settings
-       (line almost empty: contains only a single dash)
Second shortcut settings
-
...
</pre>

<p>If a configuration file contains multiple definitions for the same shortcut, Clavier+ retains only the first definition and ignores any duplicate definitions coming after. Therefore if you want to override some of your shortcuts by copy-pasting new definitions, insert the new configuration at the beginning of the file, not at the end.


<h4 id="conffile-syntax-global">Global settings</h4>

<pre>
Language=English
Size=<i>width</i>,<i>height</i>,<i>maximized</i>,<i>hide icon</i>
Columns=<i>width 1</i>,<i>width 2</i>,<i>width 3</i>,<i>width 4</i>
Sorting=<i>column index</i>
</pre>

<dl>
<dt><kbd>Language</kbd>
<dd>Specifies the language of the Clavier+ interface and, in some cases, of the configuration file keywords.<br>
Available languages: {{LANGUAGES}}

<dt><kbd>Size</kbd>
<dd><kbd>width,height</kbd>: size of the configuration window, in pixels.<br>
<kbd>maximized</kbd>: 1 if the window is maximized, 0 otherwise.<br>
<kbd>hide icon</kbd>: 1 to remove the Clavier+ icon from the <a href="https://support.microsoft.com/en-us/windows/e159e8d2-9ac5-b2bd-61c5-bb63c1d437c3">taskbar notification area</a>, 0 to keep it visible.

<dt><kbd>Columns</kbd>
<dd>Specifies the width of all columns but the last one in the configuration window. Each width is a percentage relative to the list width. The last column takes the remaining space.

<dt><kbd>Sorting</kbd>
<dd>Specifies the index of the column used to sort the list. 0 for the first column, 1 for the second one, and so on.
</dl>


<h4 id="conffile-syntax-shortcuts">Shortcuts settings</h4>

<pre>
Shortcut=<i>keystroke</i>
Code=<i>keystroke code</i> (internally used by Clavier+)
DistinguishLeftRight=<i>0 or 1</i>
Description=<i>description text</i>
Text=<i>text to type when the shortcut is done</i>
&gt;<i>Other line to type</i>
&gt;<i>Another line</i>
...
Command=<i>program to launch when the shortcut is done</i>
Directory=<i>startup directory</i>
Window=<i>window mode of the program to launch</i>
Programs=<i>programs list</i>
AllProgramsBut=<i>programs list</i>
CapsLock=<i>condition</i>
NumLock=<i>condition</i>
ScrollLock=<i>condition</i>
UsageCount=<i>count</i>
</pre>

<p>Note the requirement to type a <kbd>&gt;</kbd> character at the beginning of each additional line for the <kbd>Text=</kbd> field.

<p><kbd>Text</kbd> on one side, <kbd>Command</kbd>, <kbd>Directory</kbd>, and <kbd>Window</kbd> on the other side are mutually exclusive: a shortcut cannot write text and execute a command line at the same time.

<dl>
<dt><kbd>Shortcut</kbd>
<dd>The textual representation of the keystroke, in the same format as in the configuration window.

<dt><kbd>Code</kbd>
<dd>The numerical representation of the keystroke. Clavier+ generates this code automatically, and uses it only when unable to parse the <kbd>Shortcut</kbd> field (for example if a Windows update has changed the name of a key used in the keystroke).

<dt><kbd>DistinguishLeftRight</kbd>
<dd>Specifies whether Clavier+ should distinguish between left-side and right-side specials keys. If this setting is 1, <kbd>Ctrl</kbd>, <kbd>Alt</kbd>, <kbd>Shift</kbd> and <kbd>Win</kbd> keys located at the left side of the keyboard are distinguished from their equivalent located at the right side. This allows creating more shortcuts. If this settings is 0 (default value), the side of the special keys is not relevant in the keystroke.

<dt><kbd>Directory</kbd> (command mode only)
<dd>The startup directory of the command. If none is given, Clavier+ uses the directory of the executable itself.

<dt><kbd>Window</kbd> (command mode only)
<dd>The initial size of the main window of the launched program, among: <kbd>Normal</kbd>, <kbd>Minimized</kbd>, <kbd>Maximized</kbd>.

<dt><kbd>Programs</kbd>, <kbd>AllProgramsBut</kbd> (mutually exclusive)
<dd>Activation condition: the list of the only programs for which the shortcut is activated (<kbd>Programs</kbd>) or disabled (<kbd>AllProgramsBut</kbd>). The programs are semi-colon-separated. They do not have a full path: file name only, with extension.

<dt><kbd>CapsLock</kbd>, <kbd>NumLock</kbd>, <kbd>ScrollLock</kbd>
<dd>If specified, specifies an activation condition for the shortcut. Accepted values: <kbd>None</kbd> (default value), <kbd>Yes</kbd> and <kbd>No</kbd>.

<dt><kbd>UsageCount</kbd>
<dd>The number of times the shortcut has been used since its creation.
</dl>


<h2 id="cmdline">Command line options</h2>

<p>Clavier+ accepts the following command line options:

<dl>
<dt><kbd>/launch</kbd>
<dd>Launches Clavier+ if it is not running yet, then lets it execute in the background. The settings window is not displayed.

<dt><kbd>/settings</kbd>
<dd>Launches Clavier+ in the background if it is not running yet, then displays the settings window.

<dt><kbd>/menu</kbd>
<dd>Launches Clavier+ in the background if it is not running yet, then displays the Clavier+ menu. The menu can be displayed manually by right clicking the Clavier+ icon in the <a href="https://support.microsoft.com/en-us/windows/e159e8d2-9ac5-b2bd-61c5-bb63c1d437c3">taskbar notification area</a>.

<dt><kbd>/quit</kbd>
<dd>Quits Clavier+ silently. Does nothing if Clavier+ is not running.

<dt><kbd>/addtext</kbd>
<dd>Displays the window for adding a text shortcut. First launches Clavier+ in the background and displays the settings window, if necessary.

<dt><kbd>/addcommand</kbd>
<dd>Displays the window for adding a program launching shortcut. First launches Clavier+ in the background and displays the settings window, if necessary.

<dt><kbd>/load <i>configuration_file.ini</i></kbd>
<dd>If Clavier+ is not running, launches it and loads the given configuration file. If Clavier+ is running, does not launch it again but loads the specified configuration file. Enclose the filename in quotes if it contains spaces, for example: <kbd>clavier.exe /load "Internet shortcuts.ini"</kbd>

<dt><kbd>/merge <i>configuration_file.ini</i></kbd>
<dd>If Clavier+ is not running, launches it and merges the default configuration file (or the one specified by <kbd>/load</kbd>, if any) with the specified configuration file. If Clavier+ is running, merges the current configuration file with the specified one. Does not add merged shortcuts that create conflicts or ambiguities with the current shortcuts.

<dt><kbd>/sendkeys "<i>text</i>"</kbd>
<dd>Simulates text typing. The text follows the <a href="#text">syntax specified above</a>. This option allows, for example, to type text when double-clicking on a Windows shortcut, or at Windows startup, or when choosing a command in the Explorer context menu. Quotes and backslashes must be escaped with a backslash, for example: <kbd>clavier.exe /sendkeys "Write a \"quoted\" word and a single \\ backslash"</kbd>
</dl>

<p>If Clavier+ is launched without any argument, the behavior depends on whether Clavier+ is already running. If no, launches Clavier+ silently. If yes, does not launch Clavier+ again but display the configuration window. This allows accessing Clavier+ options even if its icon is hidden.


<h2 id="limits">Known issues</h2>

<h3 id="limits-unavailable-shortcuts">Unavailable shortcuts</h3>

<p>Clavier+ cannot capture a few special keys:
<pre>
Print Screen
Pause
F12
</pre>

<p>The special keys “Refresh browser”, “increase volume”, etc. are partially supported. Shortcuts using them can be created, and it is possible to modify their original behavior. However the action of these keys is executed when they are pressed in the <i>Add</i> dialog box. Moreover, as Windows does not provide a generic method to get the name of these special keys, they are named with a number (for example: <kbd>#183</kbd>).

<p>Windows system shortcuts cannot be modified. As of Windows 8 it includes most <kbd>Win + <i>letter</i></kbd> and <kbd>Win + <i>digit</i></kbd> shortcuts. The <a href="https://support.microsoft.com/en-us/help/12445/windows-keyboard-shortcuts">Microsoft documentation</a> lists them all.


<h3 id="limits-side-effects">Discouraged shortcuts</h3>

<p>By default on Windows, the <kbd>Alt + Shift</kbd> shortcut changes the keyboard layout. You are strongly discouraged to use shortcuts like <kbd>Alt + Shift + <i>key</i></kbd>, because you could change the keyboard layout by mistake.


<h3 id="limits-programs">Partially incompatible programs</h3>

<p>Clavier+ may encounter difficulties with some programs when typing text or simulating keystrokes:
<ul>
<li>Some cross-platform programs, which do not follow the Windows keyboard handling standards. Applies to <b>Java</b> programs, <b>OpenOffice</b>, Mozilla software (<b>Firefox</b>, <b>Thunderbird</b>), <b>Opera</b>, etc. If a problem occurs in one of those programs, use the <kbd>[|<i>text</i>|]</kbd> syntax to make Clavier+ using low-level techniques when typing text (better compatibility, but slower and more limited).
<li><b>Games</b>, because they bypass Windows, therefore Clavier+, when handling the keyboard.
<li>Other keyboard utilities, because they may detect keystrokes before Clavier+ intercepts them.
<li>System programs, because they bypass Windows too. For example: <kbd>command.com</kbd>, emulators and virtual machines (Cygwin, VirtualPC), virtualizers (VNC).
</ul>


<h3 id="limits-unicode">Unicode</h3>

<p>Clavier+ generally supports Unicode: configuration files can contain Unicode characters (UTF-16 encoding), Clavier+ can simulate typing Unicode characters. However a few limitations apply:
<ul>
<li>The Clavier+ configuration dialog box does not render Emojis in color.
<li>Some programs do not support surrogate pairs, that some Unicode characters like Emojis use.
<li>The <kbd>[|<i>text</i>|]</kbd> syntax types Unicode characters correctly only if the <a href="https://en.wikipedia.org/wiki/Unicode_input#In_Microsoft_Windows"><code>EnableHexNumpad</code></a> registry setting is enabled. The setting is disabled by default. Clavier+ uses only this standard Windows mechanism, not the custom <kbd>Alt + X</kbd> shortcut of some applications.
</ul>


<h3 id="limits-conditions">Shortcuts with conditions</h3>

<p>Clavier+ cannot intercept keystrokes conditionally. When a shortcut has a <a href="#conditions">condition</a>, Clavier+ intercepts the corresponding keystroke unconditionally, even when the condition is not met. When you press the keystroke, Clavier+ executes the shortcut action if the condition is met, else simulates the keystroke in an attempt to cancel the intercept.

<p>This behavior introduces delays and is incompatible with certain programs that intercept keystrokes in a low-level manner. For instance, Phrase Express seems to <a href="https://github.com/guilryder/clavier-plus/issues/30">detect twice</a> the keystrokes of shortcuts that have a non-matching condition.


<h3 id="limits-repetition">Repetition</h3>

<p>Some shortcuts do not allow fast repetition: you may have to release all special keys (Ctrl, Alt, etc.), and then press them again to repeat the shortcut. For instance, if you associate actions to <kbd>Ctrl + A</kbd> and <kbd>Ctrl + B</kbd>, to execute the two shortcuts sequentially you cannot do simply press <kbd>Ctrl + A</kbd> then release A and press B. You have to press <kbd>Ctrl + A</kbd>, release all keys, and then press <kbd>Ctrl + B</kbd>.

<p>This limitation exists because Clavier+ has to release the special keys for shortcuts that simulate other shortcuts or launch programs. This avoids the shortcuts to mix and the launched programs to detect that some special keys are down. For example, if <kbd>Ctrl + A</kbd> is associated to <kbd>[Alt+B]</kbd>, Clavier+ releases the <kbd>Ctrl</kbd> key, otherwise <kbd>Ctrl + Alt + B</kbd> would be simulated instead of <kbd>Alt + B</kbd>. For technical reasons, Clavier+ cannot determine whether the user has released or not the special keys before the end of the shortcut, indicating whether or not they should be pressed again to allow shortcut repetition. To avoid buggy keyboard behavior, Clavier+ never presses the special keys down again.


<h2 id="faq">Frequently Asked Questions (FAQ)</h2>

{{FAQ}}

<h2 id="examples">Shortcuts examples</h2>

{{EXAMPLES}}
